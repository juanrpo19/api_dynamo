import json
from moto import mock_dynamodb
import graphene.test
import os
import sys

sys.path.insert(1, os.getcwd())

from fastapi.testclient import TestClient
from db.models import PreaprobadosConsumoCombos , PreaprobadosComercial , TdcTasasPortal
from api.schema import schema
from api.errors import CustomFatalError, format_located_error
from utils import Utils
import random as rd
import string
from api.app import create_app

application = create_app()

# Initialize Clients
graphClient = graphene.test.Client(schema)
restClient = TestClient(application)


def test_errors_cfe():
    message = "".join([rd.choice(string.ascii_uppercase) for x in range(10)])
    cause = "".join([rd.choice(string.ascii_uppercase) for x in range(5)])
    cfe = CustomFatalError(message , cause)
    assert cfe.message == message
    assert cfe.cause == cause


def test_utils_error():
    isError1 = False
    isError2 = False
    try:
        Utils.load_config( None )
    except Exception as e:
        isError1 = e

    try:
        Utils.load_config( "" )
    except Exception as e:
        isError2 = e

    assert type(isError1) == Exception
    assert type(isError2) == Exception


# TEST BASICOS
def test_rest_health():
    response = restClient.get("/health")
    assert response.status_code == 200


def test_rest_graphql():
    response = restClient.post('/graphql/', json={"query": "{status}"})
    assert response.status_code == 200
    assert json.loads(response.content) == {
        "data": {
            "status": "Ok"
        }
    }


# TEST CON DATOS DE PRUEBA
# GENERACION DATOS DE PRUEBA
PreaprobadosConsumoCombos_data = [{
	"clave": "1#20f123cb641265b58fab2fd417e812", 
	"clave_ordenamiento": "16781043120", 
	"tipoid": "1", 
	"id": "20f123cb641265b58fab2fd417e812", 
	"nombre_cliente": "e5ebb7e36531f9a3768e25c82272ef", 
	"segmento": "PERSONAL", 
	"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
	"tel1": 3148160885, 
	"tel2": 3118080627, 
	"tel3": None, 
	"tel4": None, 
	"tel5": None, 
	"tel6": 18685227, 
	"tel7": None, 
	"tel8": None, 
	"tel9": None, 
	"tel10": None, 
	"ciudad_contacto": "BOGOTA D.C.", 
	"cupo_asigando_crediagil": "", 
	"num_prestamo": 16781043120, 
	"valor_desembolso": 500000.00, 
	"tipo_plan": "P04", 
	"producto": "CONSUMO", 
	"plazo_actual": 60, 
	"frecuencia_pago": "Mensual", 
	"tasa_namv": 0.223255, 
	"tipo_de_tasa": "Tasa Fija NAMV", 
	"fecha_desembolso": "2021-08-28", 
	"fecha_vencimiento": "2026-09-15", 
	"nueva_fecha_vencimiento": "", 
	"saldo_neto": 320121.00, 
	"cuota_regular": 14502.00, 
	"cuota_incluye_seguro": "SI", 
	"cuota_fija_k": 0, 
	"tipo_de_cuota": "cuota regular", 
	"intereses_pendientes": 3971.00, 
	"saldo_sg_vida": 400.00, 
	"fecha_prox_pago": "15-04-2024", 
	"nueva_fecha_prox_pago": "", 
	"fecha_ultimo_pago": "2024/03/15", 
	"num_cuotas_faltantes": 30, 
	"plazo_min": 36, 
	"plazo_max": 66, 
	"ampliacion_plazo_meses": 36, 
	"max_periodo_de_gracia_o_prorroga": 2, 
	"meses_prorroga_elegidos": 1, 
	"nuevo_plazo_total_en_meses": "", 
	"mes_pago_fng": "", 
	"monto_fng": "", 
	"mes_pago_comision_mipyme": "", 
	"monto_comision_mipyme": None, 
	"frec_mipyme": "", 
	"comision_mipyme_fng": "", 
	"cuota_anterior": 14502.00, 
	"vlr_cuota_actual": 14502.00, 
	"nueva_cuota_sin_otros_conceptos": "", 
	"nueva_cuota_a_capital": "", 
	"nueva_cuota_total": "", 
	"disminucion_de_cuota": "", 
	"nueva_cuota_sistema": "", 
	"marca_riesgos": "1", 
	"genero": "F", 
	"fecha_nacimiento": 19800609, 
	"email_1": "d240fa6f8e@correo.com", 
	"email_2": "d240fa6f8e@correo.com", 
	"nueva_g": "", 
	"region": "BOGOTA Y CUNDINAMARCA", 
	"codigo_seg_vida": 2, 
	"extraprima_seguro": 0, 
	"factor_seguro": 0.014400000, 
	"seguro_desempleo": 0, 
	"prob": "OTRO", 
	"televentas_habeas_data": "None", 
	"mail_habeas_data": "None", 
	"sms_habeas_data": "None", 
	"departamento": "BOGOTA D.C.    ", 
	"aliado": "KONECTA COBRANZA", 
	"base": "reactivo doc", 
	"opcion_1": "1.Ampliacion/2.Combo", 
	"opcion_2": "1.Prorroga", 
	"prioridad_creditos": 12, 
	"fecha_proyprox_pago": 20240415, 
	"redescuento": 0, 
	"concepto_distribucion1": 5, 
	"conector_distribucion1": "&", 
	"concepto_distribucion2": 2, 
	"conector_distribucion2": "&", 
	"concepto_distribucion3": 1, 
	"conector_distribucion3": "+", 
	"concepto_distribucion4": 6, 
	"conector_distribucion4": "+", 
	"concepto_distribucion5": 16, 
	"conector_distribucion5": "+", 
	"concepto_distribucion6": 17, 
	"conector_distribucion6": " ", 
	"concepto_distribucion7": 0, 
	"conector_distribucion7": " ", 
	"concepto_distribucion8": 0, 
	"conector_distribucion8": " ", 
	"concepto_distribucion9": 0, 
	"estado": "", 
	"base_aliados": "", 
	"nombre": "CARTERA PARA COBRO", 
	"grupo": "AGRUPADORES", 
	"perfil": "AGRUPADOR PREJURIDICO", 
	"cod_abogado": "999", 
	"cod_abogado_para": "999", 
	"dias_mora": 0, 
	"nombre_para": "CARTERA PARA COBRO", 
	"grupo_para": "AGRUPADORES", 
	"perfil_para": "AGRUPADOR PREJURIDICO", 
	"cobro_juridico": "None", 
	"fuente": "al dia", 
	"cnt_dias_mora": 0, 
	"consdocdeu": 53466878, 
	"nueva_marca": "", 
	"venezolanos": "No", 
	"canal_rpc_semana": "None", 
	"exclusion_rpc": "", 
	"exclusion_lc": "", 
	"novedad": "None", 
	"alternativa_aplicada_agr": "None", 
	"marca_agrupada_rgo": "None", 
	"producto_agrupado_origen": "None", 
	"f_aplicacion": None, 
	"bpo": "Sin otras aceptaciones", 
	"exclusion_alt": "", 
	"activo": 1, 
	"year": 2024, 
	"month": 4, 
	"day": 5}]


def set_up_PreaprobadosConsumoCombos():
	PreaprobadosConsumoCombos.create_table()

	for test in PreaprobadosConsumoCombos_data:
		PreaprobadosConsumoCombos(**test).save()

PreaprobadosComercial_data = [{
	"clave": "3#20f0e76e9d87260311af2aed333713", 
	"clave_ordenamiento": "5303730296619955#0", 
	"corte": 20240312, 
	"tipo_id": 3, 
	"nit_cliente": "20f0e76e9d87260311af2aed333713", 
	"razon_social": "cabd8e7056cdbdcfdde074f7045b95", 
	"segmento": "PYMES", 
	"nro_operacion": "5303730296619955", 
	"prorroga": "None", 
	"plazomax_prorroga": None, 
	"ampl_cons": "None", 
	"plazomin_ampl_cons": None, 
	"plazomax_ampl_cons": None, 
	"ampl_pg_cons": "", 
	"plazomin_ampl_pg_cons": None, 
	"plazomax_ampl_pg_cons": None, 
	"ampl_mod": "Ampliacion de plazo 36 meses", 
	"plazomin_ampl_mod": 7, 
	"plazomax_ampl_mod": 43, 
	"ampl_pg_mod": "", 
	"plazomin_ampl_pg_mod": None, 
	"plazomax_ampl_pg_mod": None, 
	"ampl_reest": "Ampliacion de plazo 48 meses", 
	"plazomin_ampl_reest": 7, 
	"plazomax_ampl_reest": 55, 
	"ampl_pg_reest": "", 
	"plazomin_ampl_pg_reest": None, 
	"plazomax_ampl_pg_reest": None, 
	"bin": 530373, 
	"descripcion_bin": "MC CORPORATE", 
	"cupo_minimo": 500000.0, 
	"id_preaprobado": "530373029661995520240311", 
	"mpio_exp_cc_cliente": "", 
	"dpto_exp_cc_cliente": "", 
	"subsegmento": "09 ", 
	"saldo_obligacion": 5220000.03, 
	"plan": "TCM", 
	"avales": "NO", 
	"desc_tipo_gtia": "None", 
	"clave_larga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
	"clave_corta": "20fa942020", 
	"asignacion": "aliado", 
	"control_pr": 0, 
	"tipo_preaprobado": "Modificacion", 
	"nivel_alerta": "Bajo", 
	"afectacion": "None", 
	"linea_redescuento": "", 
	"of_gte": 621, 
	"calife_actual": "A", 
	"ciiucenie": 4530, 
	"saldo_cliente": 5220000.03, 
	"calife": "A", 
	"califintmodred": "AA    ", 
	"califi_real": "C15", 
	"max_mora_cli": 0, 
	"endeudamiento": 7988211.0, 
	"marca_026": "None", 
	"altmora": 0.0, 
	"apl": "M", 
	"fdesem": "2022-10-31 00:00:00", 
	"vdesem": 10000000.0, 
	"seg_cuota_fut": 0.0, 
	"fecha_venc_def": "2026-10-30 00:00:00", 
	"f_prox_pago": "20240416", 
	"plazo": 7, 
	"gerenciado": "   ", 
	"pcons": "TARJETA DE CREDITO", 
	"regcons": "SUR", 
	"sector": "COMERCIO", 
	"subsector": "COMERCIO DE REPUESTOS", 
	"producto": "TARJETA DE CREDITO", 
	"fondo": "None", 
	"obl341": "05303730296619955", 
	"tipo_de_tasa": "TASA FIJA MV", 
	"tasa": 0.024103, 
	"tasa_anterior": 0.024103, 
	"id_rep_legal": 80887797, 
	"mpio_exp_cc_rep_legal": "None", 
	"dpto_exp_cc_rep_legal": "", 
	"nombre_cli_rep": "JOSE MOSHE SANDERS BARSTEIN", 
	"marca_preaprobado": "Preaprobado", 
	"marca_garantia": "NO", 
	"tipo_de_amortizacion": "Mensual", 
	"tipo_cuota": "Capital fijo", 
	"tipo_tasa": "TASA FIJA NAMV", 
	"tamano_empresa": "micro", 
	"nombre_garantia": "None", 
	"tipo_moneda": 0, 
	"bajo_monto": "X", 
	"desc_tipo_fondo": "None", 
	"proximo_pago": 20240318.0, 
	"plan_desembolso": "None", 
	"paquete_consolidacion": "No aplica proceso agil", 
	"proceso_agil_consolidacion_pasivos": " ", 
	"cuenta": "5303736042787539259", 
	"saldo_capital": 7804833.37, 
	"cuotas_faltantes": 7, 
	"periodo_de_gracia_restante": "", 
	"spread": 0.0, 
	"periodicidad_pago": "Mensual", 
	"modalidad": "Comercial", 
	"intereses_acumulados": 324362.2, 
	"otros_conceptos_acumulados": 42391.56, 
	"tasa_seguro_anual": 0.0, 
	"cod_base_seg_vida": "", 
	"valor_desembolso_para_seg_vida": 0, 
	"mes_pago_fng": "", 
	"porcent_comision_fng": 0, 
	"mes_pago_fag": "", 
	"porcent_comision_fag": 0, 
	"saldo_total_vencido": 7988210.25, 
	"saldo_capital_vencido": 7804833.37, 
	"saldo_interes_cte_vencido": 140985.32, 
	"saldo_interes_mora_causados": 0, 
	"saldo_int_mora_en_susp_causac": 0, 
	"saldo_seguros_vencidos": 0, 
	"saldo_otros_seguros": 0, 
	"comision_exp": 42391.56, 
	"iva_exp": 0, 
	"vlr_obligacion": 7988211.0, 
	"pago_min_cons": 1332553.54, 
	"consdocdeu": 63160444, 
	"nombre_usuario_dueno_tarea": "None", 
	"cod_abogado": "10026", 
	"nombre_abogado": "AGRUPADOR OBLIGACIONES AL DIA", 
	"grupo_abogado": "AGRUPADORES", 
	"perfil_abogado": "AGRUPADOR PREJURIDICO", 
	"organizacion": 807, 
	"pagares_a_consolidar": "5303730296619955", 
	"fecha1_pror": "", 
	"fecha2_pror": "", 
	"fecha3_pror": "", 
	"dtf_ta": None, 
	"ibr_namv": None, 
	"ibr_natv": None, 
	"ibr_nasv": None, 
	"ipc_vm": None, 
	"ipc_vac": None, 
	"ipc_va": None, 
	"id_embargo": "", 
	"descripcion_gestion": "None", 
	"codigo_aprobador": "", 
	"f_gestion_cobdigit": "None", 
	"activo": 1, 
	"year": 2024, 
	"month": 4, 
	"day": 5}]


def set_up_PreaprobadosComercial():
	PreaprobadosComercial.create_table()

	for test in PreaprobadosComercial_data:
		PreaprobadosComercial(**test).save()

TdcTasasPortal_data = [{
	"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
	"clave_ordenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
	"ingestion_year": 2024, 
	"ingestion_month": 3, 
	"ingestion_day": 15, 
	"costumer_number": "969e7c9f478b58b893736ff9a69f9b", 
	"tipo_id_cliente": "1", 
	"id_cliente": "ec93f229ac2a8198e5ba39c5daf373", 
	"nombre_cliente": "0434ac7a93ecca2950f9cbadb6f819", 
	"tipo_id_amparador": " ", 
	"id_amparador": "                         ", 
	"nombre_amparador": "                                        ", 
	"organizacion": 806, 
	"cuenta": "3778157021107407756", 
	"estado_cuenta": "A", 
	"block_code_1": " ", 
	"block_code_2": " ", 
	"dias_mora": 0, 
	"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
	"bin": "377815", 
	"ultimos_4_numeros": "9465", 
	"franquicia": "AMEX  ", 
	"estado_tarjeta": "0", 
	"block_code_tarjeta": " ", 
	"ciclo": 15, 
	"fecha_ultimo_corte": "20240215", 
	"fecha_limite_de_pago": "20240304", 
	"fecha_proximo_corte": "20240315", 
	"dias_proximo_corte": 0, 
	"transaciones_suspendidas": 0, 
	"monto_transaciones_suspendidas": 0, 
	"deuda_total": 63.16, 
	"comisiones_deuda_total": 0, 
	"intereses_deuda_total": 0, 
	"suma_comisiones_intereses_deuda_total": 0, 
	"capital_deuda_total": 63.16, 
	"tasa_ponderada_deuda_total": 0.02419200, 
	"tasa_pareto_deuda_total": 0.02419200, 
	"codigo_transaccion_deuda_total": "8098 ", 
	"pago_minimo_pendiente": 0, 
	"comisiones_pago_minimo_pendiente": 0, 
	"intereses_pago_minimo_pendiente": 0, 
	"suma_comisiones_intereses_pago_minimo_pendiente": 0, 
	"capital_pago_minimo_pendiente": 0, 
	"tasa_ponderada_pago_minimo": 0, 
	"tasa_pareto_pago_minimo": 0, 
	"codigo_transaccion_pago_minimo": "8304 ", 
	"plazo_maximo": "34 ", 
	"plazo_rango": "36 ", 
	"fecha_registro": "15/03/2024", 
	"hora_registro": "03:51:52", 
	"fecha_saldos": "14/03/2024", 
	"fecha_reg": 20240315, 
	"tasa_politica": 0.02419200, 
	"year": 2024, 
	"month": 3, 
	"activo": 1}]


def set_up_TdcTasasPortal():
	TdcTasasPortal.create_table()

	for test in TdcTasasPortal_data:
		TdcTasasPortal(**test).save()

# PRUEBAS CON GRAPHQL
@mock_dynamodb
def test_graphql_get_preaprobadosconsumocombos_all():
	set_up_PreaprobadosConsumoCombos()
	executed = graphClient.execute('''
            query ConsultarPreaprobadosConsumoCombosAll($clave:String, $claveOrdenamiento:String, $limit:Int , $ascendente:Boolean , $lastEvaluatedKey:LastEvaluatedKeyPreaprobadosConsumoCombos) {
            preaprobadosConsumoCombosAll(clave:$clave, claveOrdenamiento:$claveOrdenamiento, limit:$limit , ascendente:$ascendente , lastEvaluatedKey:$lastEvaluatedKey){
            totalCount,
            preaprobadosconsumocombos{
                clave , claveOrdenamiento , tipoid , id , nombreCliente , segmento , ejecutivo , tel1 , tel2 , tel3 , tel4 , tel5 , tel6 , tel7 , tel8 , tel9 , tel10 , ciudadContacto , cupoAsigandoCrediagil , numPrestamo , valorDesembolso , tipoPlan , producto , plazoActual , frecuenciaPago , tasaNamv , tipoDeTasa , fechaDesembolso , fechaVencimiento , nuevaFechaVencimiento , saldoNeto , cuotaRegular , cuotaIncluyeSeguro , cuotaFijaK , tipoDeCuota , interesesPendientes , saldoSgVida , fechaProxPago , nuevaFechaProxPago , fechaUltimoPago , numCuotasFaltantes , plazoMin , plazoMax , ampliacionPlazoMeses , maxPeriodoDeGraciaOProrroga , mesesProrrogaElegidos , nuevoPlazoTotalEnMeses , mesPagoFng , montoFng , mesPagoComisionMipyme , montoComisionMipyme , frecMipyme , comisionMipymeFng , cuotaAnterior , vlrCuotaActual , nuevaCuotaSinOtrosConceptos , nuevaCuotaACapital , nuevaCuotaTotal , disminucionDeCuota , nuevaCuotaSistema , marcaRiesgos , genero , fechaNacimiento , email1 , email2 , nuevaG , region , codigoSegVida , extraprimaSeguro , factorSeguro , seguroDesempleo , prob , televentasHabeasData , mailHabeasData , smsHabeasData , departamento , aliado , base , opcion1 , opcion2 , prioridadCreditos , fechaProyproxPago , redescuento , conceptoDistribucion1 , conectorDistribucion1 , conceptoDistribucion2 , conectorDistribucion2 , conceptoDistribucion3 , conectorDistribucion3 , conceptoDistribucion4 , conectorDistribucion4 , conceptoDistribucion5 , conectorDistribucion5 , conceptoDistribucion6 , conectorDistribucion6 , conceptoDistribucion7 , conectorDistribucion7 , conceptoDistribucion8 , conectorDistribucion8 , conceptoDistribucion9 , estado , baseAliados , nombre , grupo , perfil , codAbogado , codAbogadoPara , diasMora , nombrePara , grupoPara , perfilPara , cobroJuridico , fuente , cntDiasMora , consdocdeu , nuevaMarca , venezolanos , canalRpcSemana , exclusionRpc , exclusionLc , novedad , alternativaAplicadaAgr , marcaAgrupadaRgo , productoAgrupadoOrigen , fAplicacion , bpo , exclusionAlt , activo , year , month , day
                }
            }
            }''', variables={"clave": "1#20f123cb641265b58fab2fd417e812", "claveOrdenamiento": "16781043120"})
            
	assert json.loads(json.dumps(executed)) =={
		"data":{
			"preaprobadosConsumoCombosAll":{
				"totalCount": 1,
				"preaprobadosconsumocombos":[{
				"clave": "1#20f123cb641265b58fab2fd417e812", 
				"claveOrdenamiento": "16781043120", 
				"tipoid": "1", 
				"id": "20f123cb641265b58fab2fd417e812", 
				"nombreCliente": "e5ebb7e36531f9a3768e25c82272ef", 
				"segmento": "PERSONAL", 
				"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
				"tel1": 3148160885, 
				"tel2": 3118080627, 
				"tel3": None, 
				"tel4": None, 
				"tel5": None, 
				"tel6": 18685227, 
				"tel7": None, 
				"tel8": None, 
				"tel9": None, 
				"tel10": None, 
				"ciudadContacto": "BOGOTA D.C.", 
				"cupoAsigandoCrediagil": "", 
				"numPrestamo": 16781043120, 
				"valorDesembolso": 500000.00, 
				"tipoPlan": "P04", 
				"producto": "CONSUMO", 
				"plazoActual": 60, 
				"frecuenciaPago": "Mensual", 
				"tasaNamv": 0.223255, 
				"tipoDeTasa": "Tasa Fija NAMV", 
				"fechaDesembolso": "2021-08-28", 
				"fechaVencimiento": "2026-09-15", 
				"nuevaFechaVencimiento": "", 
				"saldoNeto": 320121.00, 
				"cuotaRegular": 14502.00, 
				"cuotaIncluyeSeguro": "SI", 
				"cuotaFijaK": 0, 
				"tipoDeCuota": "cuota regular", 
				"interesesPendientes": 3971.00, 
				"saldoSgVida": 400.00, 
				"fechaProxPago": "15-04-2024", 
				"nuevaFechaProxPago": "", 
				"fechaUltimoPago": "2024/03/15", 
				"numCuotasFaltantes": 30, 
				"plazoMin": 36, 
				"plazoMax": 66, 
				"ampliacionPlazoMeses": 36, 
				"maxPeriodoDeGraciaOProrroga": 2, 
				"mesesProrrogaElegidos": 1, 
				"nuevoPlazoTotalEnMeses": "", 
				"mesPagoFng": "", 
				"montoFng": "", 
				"mesPagoComisionMipyme": "", 
				"montoComisionMipyme": None, 
				"frecMipyme": "", 
				"comisionMipymeFng": "", 
				"cuotaAnterior": 14502.00, 
				"vlrCuotaActual": 14502.00, 
				"nuevaCuotaSinOtrosConceptos": "", 
				"nuevaCuotaACapital": "", 
				"nuevaCuotaTotal": "", 
				"disminucionDeCuota": "", 
				"nuevaCuotaSistema": "", 
				"marcaRiesgos": "1", 
				"genero": "F", 
				"fechaNacimiento": 19800609, 
				"email1": "d240fa6f8e@correo.com", 
				"email2": "d240fa6f8e@correo.com", 
				"nuevaG": "", 
				"region": "BOGOTA Y CUNDINAMARCA", 
				"codigoSegVida": 2, 
				"extraprimaSeguro": 0, 
				"factorSeguro": 0.014400000, 
				"seguroDesempleo": 0, 
				"prob": "OTRO", 
				"televentasHabeasData": "None", 
				"mailHabeasData": "None", 
				"smsHabeasData": "None", 
				"departamento": "BOGOTA D.C.    ", 
				"aliado": "KONECTA COBRANZA", 
				"base": "reactivo doc", 
				"opcion1": "1.Ampliacion/2.Combo", 
				"opcion2": "1.Prorroga", 
				"prioridadCreditos": 12, 
				"fechaProyproxPago": 20240415, 
				"redescuento": 0, 
				"conceptoDistribucion1": 5, 
				"conectorDistribucion1": "&", 
				"conceptoDistribucion2": 2, 
				"conectorDistribucion2": "&", 
				"conceptoDistribucion3": 1, 
				"conectorDistribucion3": "+", 
				"conceptoDistribucion4": 6, 
				"conectorDistribucion4": "+", 
				"conceptoDistribucion5": 16, 
				"conectorDistribucion5": "+", 
				"conceptoDistribucion6": 17, 
				"conectorDistribucion6": " ", 
				"conceptoDistribucion7": 0, 
				"conectorDistribucion7": " ", 
				"conceptoDistribucion8": 0, 
				"conectorDistribucion8": " ", 
				"conceptoDistribucion9": 0, 
				"estado": "", 
				"baseAliados": "", 
				"nombre": "CARTERA PARA COBRO", 
				"grupo": "AGRUPADORES", 
				"perfil": "AGRUPADOR PREJURIDICO", 
				"codAbogado": "999", 
				"codAbogadoPara": "999", 
				"diasMora": 0, 
				"nombrePara": "CARTERA PARA COBRO", 
				"grupoPara": "AGRUPADORES", 
				"perfilPara": "AGRUPADOR PREJURIDICO", 
				"cobroJuridico": "None", 
				"fuente": "al dia", 
				"cntDiasMora": 0, 
				"consdocdeu": 53466878, 
				"nuevaMarca": "", 
				"venezolanos": "No", 
				"canalRpcSemana": "None", 
				"exclusionRpc": "", 
				"exclusionLc": "", 
				"novedad": "None", 
				"alternativaAplicadaAgr": "None", 
				"marcaAgrupadaRgo": "None", 
				"productoAgrupadoOrigen": "None", 
				"fAplicacion": None, 
				"bpo": "Sin otras aceptaciones", 
				"exclusionAlt": "", 
				"activo": 1, 
				"year": 2024, 
				"month": 4, 
				"day": 5}]}}}


@mock_dynamodb
def test_graphql_get_preaprobadosconsumocombos():
	set_up_PreaprobadosConsumoCombos()
	executed = graphClient.execute('''
            query ConsultarPreaprobadosConsumoCombos($clave:String, $claveOrdenamiento:String, $limit:Int , $ascendente:Boolean , $lastEvaluatedKey:LastEvaluatedKeyPreaprobadosConsumoCombos) {
                preaprobadosConsumoCombos(clave:$clave, claveOrdenamiento:$claveOrdenamiento, limit:$limit , ascendente:$ascendente , lastEvaluatedKey:$lastEvaluatedKey){clave , claveOrdenamiento , tipoid , id , nombreCliente , segmento , ejecutivo , tel1 , tel2 , tel3 , tel4 , tel5 , tel6 , tel7 , tel8 , tel9 , tel10 , ciudadContacto , cupoAsigandoCrediagil , numPrestamo , valorDesembolso , tipoPlan , producto , plazoActual , frecuenciaPago , tasaNamv , tipoDeTasa , fechaDesembolso , fechaVencimiento , nuevaFechaVencimiento , saldoNeto , cuotaRegular , cuotaIncluyeSeguro , cuotaFijaK , tipoDeCuota , interesesPendientes , saldoSgVida , fechaProxPago , nuevaFechaProxPago , fechaUltimoPago , numCuotasFaltantes , plazoMin , plazoMax , ampliacionPlazoMeses , maxPeriodoDeGraciaOProrroga , mesesProrrogaElegidos , nuevoPlazoTotalEnMeses , mesPagoFng , montoFng , mesPagoComisionMipyme , montoComisionMipyme , frecMipyme , comisionMipymeFng , cuotaAnterior , vlrCuotaActual , nuevaCuotaSinOtrosConceptos , nuevaCuotaACapital , nuevaCuotaTotal , disminucionDeCuota , nuevaCuotaSistema , marcaRiesgos , genero , fechaNacimiento , email1 , email2 , nuevaG , region , codigoSegVida , extraprimaSeguro , factorSeguro , seguroDesempleo , prob , televentasHabeasData , mailHabeasData , smsHabeasData , departamento , aliado , base , opcion1 , opcion2 , prioridadCreditos , fechaProyproxPago , redescuento , conceptoDistribucion1 , conectorDistribucion1 , conceptoDistribucion2 , conectorDistribucion2 , conceptoDistribucion3 , conectorDistribucion3 , conceptoDistribucion4 , conectorDistribucion4 , conceptoDistribucion5 , conectorDistribucion5 , conceptoDistribucion6 , conectorDistribucion6 , conceptoDistribucion7 , conectorDistribucion7 , conceptoDistribucion8 , conectorDistribucion8 , conceptoDistribucion9 , estado , baseAliados , nombre , grupo , perfil , codAbogado , codAbogadoPara , diasMora , nombrePara , grupoPara , perfilPara , cobroJuridico , fuente , cntDiasMora , consdocdeu , nuevaMarca , venezolanos , canalRpcSemana , exclusionRpc , exclusionLc , novedad , alternativaAplicadaAgr , marcaAgrupadaRgo , productoAgrupadoOrigen , fAplicacion , bpo , exclusionAlt , activo , year , month , day}
            }''', variables={"clave": "1#20f123cb641265b58fab2fd417e812", "claveOrdenamiento": "16781043120"})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{
			"preaprobadosConsumoCombos":[{
			"clave": "1#20f123cb641265b58fab2fd417e812", 
			"claveOrdenamiento": "16781043120", 
			"tipoid": "1", 
			"id": "20f123cb641265b58fab2fd417e812", 
			"nombreCliente": "e5ebb7e36531f9a3768e25c82272ef", 
			"segmento": "PERSONAL", 
			"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
			"tel1": 3148160885, 
			"tel2": 3118080627, 
			"tel3": None, 
			"tel4": None, 
			"tel5": None, 
			"tel6": 18685227, 
			"tel7": None, 
			"tel8": None, 
			"tel9": None, 
			"tel10": None, 
			"ciudadContacto": "BOGOTA D.C.", 
			"cupoAsigandoCrediagil": "", 
			"numPrestamo": 16781043120, 
			"valorDesembolso": 500000.00, 
			"tipoPlan": "P04", 
			"producto": "CONSUMO", 
			"plazoActual": 60, 
			"frecuenciaPago": "Mensual", 
			"tasaNamv": 0.223255, 
			"tipoDeTasa": "Tasa Fija NAMV", 
			"fechaDesembolso": "2021-08-28", 
			"fechaVencimiento": "2026-09-15", 
			"nuevaFechaVencimiento": "", 
			"saldoNeto": 320121.00, 
			"cuotaRegular": 14502.00, 
			"cuotaIncluyeSeguro": "SI", 
			"cuotaFijaK": 0, 
			"tipoDeCuota": "cuota regular", 
			"interesesPendientes": 3971.00, 
			"saldoSgVida": 400.00, 
			"fechaProxPago": "15-04-2024", 
			"nuevaFechaProxPago": "", 
			"fechaUltimoPago": "2024/03/15", 
			"numCuotasFaltantes": 30, 
			"plazoMin": 36, 
			"plazoMax": 66, 
			"ampliacionPlazoMeses": 36, 
			"maxPeriodoDeGraciaOProrroga": 2, 
			"mesesProrrogaElegidos": 1, 
			"nuevoPlazoTotalEnMeses": "", 
			"mesPagoFng": "", 
			"montoFng": "", 
			"mesPagoComisionMipyme": "", 
			"montoComisionMipyme": None, 
			"frecMipyme": "", 
			"comisionMipymeFng": "", 
			"cuotaAnterior": 14502.00, 
			"vlrCuotaActual": 14502.00, 
			"nuevaCuotaSinOtrosConceptos": "", 
			"nuevaCuotaACapital": "", 
			"nuevaCuotaTotal": "", 
			"disminucionDeCuota": "", 
			"nuevaCuotaSistema": "", 
			"marcaRiesgos": "1", 
			"genero": "F", 
			"fechaNacimiento": 19800609, 
			"email1": "d240fa6f8e@correo.com", 
			"email2": "d240fa6f8e@correo.com", 
			"nuevaG": "", 
			"region": "BOGOTA Y CUNDINAMARCA", 
			"codigoSegVida": 2, 
			"extraprimaSeguro": 0, 
			"factorSeguro": 0.014400000, 
			"seguroDesempleo": 0, 
			"prob": "OTRO", 
			"televentasHabeasData": "None", 
			"mailHabeasData": "None", 
			"smsHabeasData": "None", 
			"departamento": "BOGOTA D.C.    ", 
			"aliado": "KONECTA COBRANZA", 
			"base": "reactivo doc", 
			"opcion1": "1.Ampliacion/2.Combo", 
			"opcion2": "1.Prorroga", 
			"prioridadCreditos": 12, 
			"fechaProyproxPago": 20240415, 
			"redescuento": 0, 
			"conceptoDistribucion1": 5, 
			"conectorDistribucion1": "&", 
			"conceptoDistribucion2": 2, 
			"conectorDistribucion2": "&", 
			"conceptoDistribucion3": 1, 
			"conectorDistribucion3": "+", 
			"conceptoDistribucion4": 6, 
			"conectorDistribucion4": "+", 
			"conceptoDistribucion5": 16, 
			"conectorDistribucion5": "+", 
			"conceptoDistribucion6": 17, 
			"conectorDistribucion6": " ", 
			"conceptoDistribucion7": 0, 
			"conectorDistribucion7": " ", 
			"conceptoDistribucion8": 0, 
			"conectorDistribucion8": " ", 
			"conceptoDistribucion9": 0, 
			"estado": "", 
			"baseAliados": "", 
			"nombre": "CARTERA PARA COBRO", 
			"grupo": "AGRUPADORES", 
			"perfil": "AGRUPADOR PREJURIDICO", 
			"codAbogado": "999", 
			"codAbogadoPara": "999", 
			"diasMora": 0, 
			"nombrePara": "CARTERA PARA COBRO", 
			"grupoPara": "AGRUPADORES", 
			"perfilPara": "AGRUPADOR PREJURIDICO", 
			"cobroJuridico": "None", 
			"fuente": "al dia", 
			"cntDiasMora": 0, 
			"consdocdeu": 53466878, 
			"nuevaMarca": "", 
			"venezolanos": "No", 
			"canalRpcSemana": "None", 
			"exclusionRpc": "", 
			"exclusionLc": "", 
			"novedad": "None", 
			"alternativaAplicadaAgr": "None", 
			"marcaAgrupadaRgo": "None", 
			"productoAgrupadoOrigen": "None", 
			"fAplicacion": None, 
			"bpo": "Sin otras aceptaciones", 
			"exclusionAlt": "", 
			"activo": 1, 
			"year": 2024, 
			"month": 4, 
			"day": 5}]}}


@mock_dynamodb
def test_graphql_create_preaprobadosconsumocombos():
	set_up_PreaprobadosConsumoCombos()
	executed = graphClient.execute('''
            mutation CrearPreaprobadosConsumoCombos($preaprobadosConsumoCombosData:PreaprobadosConsumoCombosDataInput) {
                createPreaprobadosConsumoCombos(preaprobadosConsumoCombosData:$preaprobadosConsumoCombosData){
                    preaprobadosConsumoCombos{
                        clave , claveOrdenamiento , tipoid , id , nombreCliente , segmento , ejecutivo , tel1 , tel2 , tel3 , tel4 , tel5 , tel6 , tel7 , tel8 , tel9 , tel10 , ciudadContacto , cupoAsigandoCrediagil , numPrestamo , valorDesembolso , tipoPlan , producto , plazoActual , frecuenciaPago , tasaNamv , tipoDeTasa , fechaDesembolso , fechaVencimiento , nuevaFechaVencimiento , saldoNeto , cuotaRegular , cuotaIncluyeSeguro , cuotaFijaK , tipoDeCuota , interesesPendientes , saldoSgVida , fechaProxPago , nuevaFechaProxPago , fechaUltimoPago , numCuotasFaltantes , plazoMin , plazoMax , ampliacionPlazoMeses , maxPeriodoDeGraciaOProrroga , mesesProrrogaElegidos , nuevoPlazoTotalEnMeses , mesPagoFng , montoFng , mesPagoComisionMipyme , montoComisionMipyme , frecMipyme , comisionMipymeFng , cuotaAnterior , vlrCuotaActual , nuevaCuotaSinOtrosConceptos , nuevaCuotaACapital , nuevaCuotaTotal , disminucionDeCuota , nuevaCuotaSistema , marcaRiesgos , genero , fechaNacimiento , email1 , email2 , nuevaG , region , codigoSegVida , extraprimaSeguro , factorSeguro , seguroDesempleo , prob , televentasHabeasData , mailHabeasData , smsHabeasData , departamento , aliado , base , opcion1 , opcion2 , prioridadCreditos , fechaProyproxPago , redescuento , conceptoDistribucion1 , conectorDistribucion1 , conceptoDistribucion2 , conectorDistribucion2 , conceptoDistribucion3 , conectorDistribucion3 , conceptoDistribucion4 , conectorDistribucion4 , conceptoDistribucion5 , conectorDistribucion5 , conceptoDistribucion6 , conectorDistribucion6 , conceptoDistribucion7 , conectorDistribucion7 , conceptoDistribucion8 , conectorDistribucion8 , conceptoDistribucion9 , estado , baseAliados , nombre , grupo , perfil , codAbogado , codAbogadoPara , diasMora , nombrePara , grupoPara , perfilPara , cobroJuridico , fuente , cntDiasMora , consdocdeu , nuevaMarca , venezolanos , canalRpcSemana , exclusionRpc , exclusionLc , novedad , alternativaAplicadaAgr , marcaAgrupadaRgo , productoAgrupadoOrigen , fAplicacion , bpo , exclusionAlt , activo , year , month , day
                    }}}''', variables={
                "preaprobadosConsumoCombosData": {
					"clave": "1#20f123cb641265b58fab2fd417e812", 
					"claveOrdenamiento": "16781043120", 
					"tipoid": "1", 
					"id": "20f123cb641265b58fab2fd417e812", 
					"nombreCliente": "e5ebb7e36531f9a3768e25c82272ef", 
					"segmento": "PERSONAL", 
					"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
					"tel1": 3148160885, 
					"tel2": 3118080627, 
					"tel3": None, 
					"tel4": None, 
					"tel5": None, 
					"tel6": 18685227, 
					"tel7": None, 
					"tel8": None, 
					"tel9": None, 
					"tel10": None, 
					"ciudadContacto": "BOGOTA D.C.", 
					"cupoAsigandoCrediagil": "", 
					"numPrestamo": 16781043120, 
					"valorDesembolso": 500000.00, 
					"tipoPlan": "P04", 
					"producto": "CONSUMO", 
					"plazoActual": 60, 
					"frecuenciaPago": "Mensual", 
					"tasaNamv": 0.223255, 
					"tipoDeTasa": "Tasa Fija NAMV", 
					"fechaDesembolso": "2021-08-28", 
					"fechaVencimiento": "2026-09-15", 
					"nuevaFechaVencimiento": "", 
					"saldoNeto": 320121.00, 
					"cuotaRegular": 14502.00, 
					"cuotaIncluyeSeguro": "SI", 
					"cuotaFijaK": 0, 
					"tipoDeCuota": "cuota regular", 
					"interesesPendientes": 3971.00, 
					"saldoSgVida": 400.00, 
					"fechaProxPago": "15-04-2024", 
					"nuevaFechaProxPago": "", 
					"fechaUltimoPago": "2024/03/15", 
					"numCuotasFaltantes": 30, 
					"plazoMin": 36, 
					"plazoMax": 66, 
					"ampliacionPlazoMeses": 36, 
					"maxPeriodoDeGraciaOProrroga": 2, 
					"mesesProrrogaElegidos": 1, 
					"nuevoPlazoTotalEnMeses": "", 
					"mesPagoFng": "", 
					"montoFng": "", 
					"mesPagoComisionMipyme": "", 
					"montoComisionMipyme": None, 
					"frecMipyme": "", 
					"comisionMipymeFng": "", 
					"cuotaAnterior": 14502.00, 
					"vlrCuotaActual": 14502.00, 
					"nuevaCuotaSinOtrosConceptos": "", 
					"nuevaCuotaACapital": "", 
					"nuevaCuotaTotal": "", 
					"disminucionDeCuota": "", 
					"nuevaCuotaSistema": "", 
					"marcaRiesgos": "1", 
					"genero": "F", 
					"fechaNacimiento": 19800609, 
					"email1": "d240fa6f8e@correo.com", 
					"email2": "d240fa6f8e@correo.com", 
					"nuevaG": "", 
					"region": "BOGOTA Y CUNDINAMARCA", 
					"codigoSegVida": 2, 
					"extraprimaSeguro": 0, 
					"factorSeguro": 0.014400000, 
					"seguroDesempleo": 0, 
					"prob": "OTRO", 
					"televentasHabeasData": "None", 
					"mailHabeasData": "None", 
					"smsHabeasData": "None", 
					"departamento": "BOGOTA D.C.    ", 
					"aliado": "KONECTA COBRANZA", 
					"base": "reactivo doc", 
					"opcion1": "1.Ampliacion/2.Combo", 
					"opcion2": "1.Prorroga", 
					"prioridadCreditos": 12, 
					"fechaProyproxPago": 20240415, 
					"redescuento": 0, 
					"conceptoDistribucion1": 5, 
					"conectorDistribucion1": "&", 
					"conceptoDistribucion2": 2, 
					"conectorDistribucion2": "&", 
					"conceptoDistribucion3": 1, 
					"conectorDistribucion3": "+", 
					"conceptoDistribucion4": 6, 
					"conectorDistribucion4": "+", 
					"conceptoDistribucion5": 16, 
					"conectorDistribucion5": "+", 
					"conceptoDistribucion6": 17, 
					"conectorDistribucion6": " ", 
					"conceptoDistribucion7": 0, 
					"conectorDistribucion7": " ", 
					"conceptoDistribucion8": 0, 
					"conectorDistribucion8": " ", 
					"conceptoDistribucion9": 0, 
					"estado": "", 
					"baseAliados": "", 
					"nombre": "CARTERA PARA COBRO", 
					"grupo": "AGRUPADORES", 
					"perfil": "AGRUPADOR PREJURIDICO", 
					"codAbogado": "999", 
					"codAbogadoPara": "999", 
					"diasMora": 0, 
					"nombrePara": "CARTERA PARA COBRO", 
					"grupoPara": "AGRUPADORES", 
					"perfilPara": "AGRUPADOR PREJURIDICO", 
					"cobroJuridico": "None", 
					"fuente": "al dia", 
					"cntDiasMora": 0, 
					"consdocdeu": 53466878, 
					"nuevaMarca": "", 
					"venezolanos": "No", 
					"canalRpcSemana": "None", 
					"exclusionRpc": "", 
					"exclusionLc": "", 
					"novedad": "None", 
					"alternativaAplicadaAgr": "None", 
					"marcaAgrupadaRgo": "None", 
					"productoAgrupadoOrigen": "None", 
					"fAplicacion": None, 
					"bpo": "Sin otras aceptaciones", 
					"exclusionAlt": "", 
					"activo": 1, 
					"year": 2024, 
					"month": 4, 
					"day": 5}})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{
			"createPreaprobadosConsumoCombos":{
			"preaprobadosConsumoCombos":{
			"clave": "1#20f123cb641265b58fab2fd417e812", 
			"claveOrdenamiento": "16781043120", 
			"tipoid": "1", 
			"id": "20f123cb641265b58fab2fd417e812", 
			"nombreCliente": "e5ebb7e36531f9a3768e25c82272ef", 
			"segmento": "PERSONAL", 
			"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
			"tel1": 3148160885, 
			"tel2": 3118080627, 
			"tel3": None, 
			"tel4": None, 
			"tel5": None, 
			"tel6": 18685227, 
			"tel7": None, 
			"tel8": None, 
			"tel9": None, 
			"tel10": None, 
			"ciudadContacto": "BOGOTA D.C.", 
			"cupoAsigandoCrediagil": "", 
			"numPrestamo": 16781043120, 
			"valorDesembolso": 500000.00, 
			"tipoPlan": "P04", 
			"producto": "CONSUMO", 
			"plazoActual": 60, 
			"frecuenciaPago": "Mensual", 
			"tasaNamv": 0.223255, 
			"tipoDeTasa": "Tasa Fija NAMV", 
			"fechaDesembolso": "2021-08-28", 
			"fechaVencimiento": "2026-09-15", 
			"nuevaFechaVencimiento": "", 
			"saldoNeto": 320121.00, 
			"cuotaRegular": 14502.00, 
			"cuotaIncluyeSeguro": "SI", 
			"cuotaFijaK": 0, 
			"tipoDeCuota": "cuota regular", 
			"interesesPendientes": 3971.00, 
			"saldoSgVida": 400.00, 
			"fechaProxPago": "15-04-2024", 
			"nuevaFechaProxPago": "", 
			"fechaUltimoPago": "2024/03/15", 
			"numCuotasFaltantes": 30, 
			"plazoMin": 36, 
			"plazoMax": 66, 
			"ampliacionPlazoMeses": 36, 
			"maxPeriodoDeGraciaOProrroga": 2, 
			"mesesProrrogaElegidos": 1, 
			"nuevoPlazoTotalEnMeses": "", 
			"mesPagoFng": "", 
			"montoFng": "", 
			"mesPagoComisionMipyme": "", 
			"montoComisionMipyme": None, 
			"frecMipyme": "", 
			"comisionMipymeFng": "", 
			"cuotaAnterior": 14502.00, 
			"vlrCuotaActual": 14502.00, 
			"nuevaCuotaSinOtrosConceptos": "", 
			"nuevaCuotaACapital": "", 
			"nuevaCuotaTotal": "", 
			"disminucionDeCuota": "", 
			"nuevaCuotaSistema": "", 
			"marcaRiesgos": "1", 
			"genero": "F", 
			"fechaNacimiento": 19800609, 
			"email1": "d240fa6f8e@correo.com", 
			"email2": "d240fa6f8e@correo.com", 
			"nuevaG": "", 
			"region": "BOGOTA Y CUNDINAMARCA", 
			"codigoSegVida": 2, 
			"extraprimaSeguro": 0, 
			"factorSeguro": 0.014400000, 
			"seguroDesempleo": 0, 
			"prob": "OTRO", 
			"televentasHabeasData": "None", 
			"mailHabeasData": "None", 
			"smsHabeasData": "None", 
			"departamento": "BOGOTA D.C.    ", 
			"aliado": "KONECTA COBRANZA", 
			"base": "reactivo doc", 
			"opcion1": "1.Ampliacion/2.Combo", 
			"opcion2": "1.Prorroga", 
			"prioridadCreditos": 12, 
			"fechaProyproxPago": 20240415, 
			"redescuento": 0, 
			"conceptoDistribucion1": 5, 
			"conectorDistribucion1": "&", 
			"conceptoDistribucion2": 2, 
			"conectorDistribucion2": "&", 
			"conceptoDistribucion3": 1, 
			"conectorDistribucion3": "+", 
			"conceptoDistribucion4": 6, 
			"conectorDistribucion4": "+", 
			"conceptoDistribucion5": 16, 
			"conectorDistribucion5": "+", 
			"conceptoDistribucion6": 17, 
			"conectorDistribucion6": " ", 
			"conceptoDistribucion7": 0, 
			"conectorDistribucion7": " ", 
			"conceptoDistribucion8": 0, 
			"conectorDistribucion8": " ", 
			"conceptoDistribucion9": 0, 
			"estado": "", 
			"baseAliados": "", 
			"nombre": "CARTERA PARA COBRO", 
			"grupo": "AGRUPADORES", 
			"perfil": "AGRUPADOR PREJURIDICO", 
			"codAbogado": "999", 
			"codAbogadoPara": "999", 
			"diasMora": 0, 
			"nombrePara": "CARTERA PARA COBRO", 
			"grupoPara": "AGRUPADORES", 
			"perfilPara": "AGRUPADOR PREJURIDICO", 
			"cobroJuridico": "None", 
			"fuente": "al dia", 
			"cntDiasMora": 0, 
			"consdocdeu": 53466878, 
			"nuevaMarca": "", 
			"venezolanos": "No", 
			"canalRpcSemana": "None", 
			"exclusionRpc": "", 
			"exclusionLc": "", 
			"novedad": "None", 
			"alternativaAplicadaAgr": "None", 
			"marcaAgrupadaRgo": "None", 
			"productoAgrupadoOrigen": "None", 
			"fAplicacion": None, 
			"bpo": "Sin otras aceptaciones", 
			"exclusionAlt": "", 
			"activo": 1, 
			"year": 2024, 
			"month": 4, 
			"day": 5}}}}


@mock_dynamodb
def test_graphql_delete_preaprobadosconsumocombos():
	set_up_PreaprobadosConsumoCombos()
	executed = graphClient.execute('''
            mutation BorrarPreaprobadosConsumoCombos($preaprobadosConsumoCombosData:PreaprobadosConsumoCombosDataInput) {
                deletePreaprobadosConsumoCombos(preaprobadosConsumoCombosData:$preaprobadosConsumoCombosData){status}
            }''', variables={"preaprobadosConsumoCombosData": {"clave": "1#20f123cb641265b58fab2fd417e812", "claveOrdenamiento": "16781043120"}})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{"deletePreaprobadosConsumoCombos":{"status":True}}}


@mock_dynamodb
def test_graphql_get_preaprobadoscomercial_all():
	set_up_PreaprobadosComercial()
	executed = graphClient.execute('''
            query ConsultarPreaprobadosComercialAll($clave:String, $claveOrdenamiento:String, $limit:Int , $ascendente:Boolean , $lastEvaluatedKey:LastEvaluatedKeyPreaprobadosComercial) {
            preaprobadosComercialAll(clave:$clave, claveOrdenamiento:$claveOrdenamiento, limit:$limit , ascendente:$ascendente , lastEvaluatedKey:$lastEvaluatedKey){
            totalCount,
            preaprobadoscomercial{
                clave , claveOrdenamiento , corte , tipoId , nitCliente , razonSocial , segmento , nroOperacion , prorroga , plazomaxProrroga , amplCons , plazominAmplCons , plazomaxAmplCons , amplPgCons , plazominAmplPgCons , plazomaxAmplPgCons , amplMod , plazominAmplMod , plazomaxAmplMod , amplPgMod , plazominAmplPgMod , plazomaxAmplPgMod , amplReest , plazominAmplReest , plazomaxAmplReest , amplPgReest , plazominAmplPgReest , plazomaxAmplPgReest , bin , descripcionBin , cupoMinimo , idPreaprobado , mpioExpCcCliente , dptoExpCcCliente , subsegmento , saldoObligacion , plan , avales , descTipoGtia , claveLarga , claveCorta , asignacion , controlPr , tipoPreaprobado , nivelAlerta , afectacion , lineaRedescuento , ofGte , califeActual , ciiucenie , saldoCliente , calife , califintmodred , califiReal , maxMoraCli , endeudamiento , marca026 , altmora , apl , fdesem , vdesem , segCuotaFut , fechaVencDef , fProxPago , plazo , gerenciado , pcons , regcons , sector , subsector , producto , fondo , obl341 , tipoDeTasa , tasa , tasaAnterior , idRepLegal , mpioExpCcRepLegal , dptoExpCcRepLegal , nombreCliRep , marcaPreaprobado , marcaGarantia , tipoDeAmortizacion , tipoCuota , tipoTasa , tamanoEmpresa , nombreGarantia , tipoMoneda , bajoMonto , descTipoFondo , proximoPago , planDesembolso , paqueteConsolidacion , procesoAgilConsolidacionPasivos , cuenta , saldoCapital , cuotasFaltantes , periodoDeGraciaRestante , spread , periodicidadPago , modalidad , interesesAcumulados , otrosConceptosAcumulados , tasaSeguroAnual , codBaseSegVida , valorDesembolsoParaSegVida , mesPagoFng , porcentComisionFng , mesPagoFag , porcentComisionFag , saldoTotalVencido , saldoCapitalVencido , saldoInteresCteVencido , saldoInteresMoraCausados , saldoIntMoraEnSuspCausac , saldoSegurosVencidos , saldoOtrosSeguros , comisionExp , ivaExp , vlrObligacion , pagoMinCons , consdocdeu , nombreUsuarioDuenoTarea , codAbogado , nombreAbogado , grupoAbogado , perfilAbogado , organizacion , pagaresAConsolidar , fecha1Pror , fecha2Pror , fecha3Pror , dtfTa , ibrNamv , ibrNatv , ibrNasv , ipcVm , ipcVac , ipcVa , idEmbargo , descripcionGestion , codigoAprobador , fGestionCobdigit , activo , year , month , day
                }
            }
            }''', variables={"clave": "3#20f0e76e9d87260311af2aed333713", "claveOrdenamiento": "5303730296619955#0"})
            
	assert json.loads(json.dumps(executed)) =={
		"data":{
			"preaprobadosComercialAll":{
				"totalCount": 1,
				"preaprobadoscomercial":[{
				"clave": "3#20f0e76e9d87260311af2aed333713", 
				"claveOrdenamiento": "5303730296619955#0", 
				"corte": 20240312, 
				"tipoId": 3, 
				"nitCliente": "20f0e76e9d87260311af2aed333713", 
				"razonSocial": "cabd8e7056cdbdcfdde074f7045b95", 
				"segmento": "PYMES", 
				"nroOperacion": "5303730296619955", 
				"prorroga": "None", 
				"plazomaxProrroga": None, 
				"amplCons": "None", 
				"plazominAmplCons": None, 
				"plazomaxAmplCons": None, 
				"amplPgCons": "", 
				"plazominAmplPgCons": None, 
				"plazomaxAmplPgCons": None, 
				"amplMod": "Ampliacion de plazo 36 meses", 
				"plazominAmplMod": 7, 
				"plazomaxAmplMod": 43, 
				"amplPgMod": "", 
				"plazominAmplPgMod": None, 
				"plazomaxAmplPgMod": None, 
				"amplReest": "Ampliacion de plazo 48 meses", 
				"plazominAmplReest": 7, 
				"plazomaxAmplReest": 55, 
				"amplPgReest": "", 
				"plazominAmplPgReest": None, 
				"plazomaxAmplPgReest": None, 
				"bin": 530373, 
				"descripcionBin": "MC CORPORATE", 
				"cupoMinimo": 500000.0, 
				"idPreaprobado": "530373029661995520240311", 
				"mpioExpCcCliente": "", 
				"dptoExpCcCliente": "", 
				"subsegmento": "09 ", 
				"saldoObligacion": 5220000.03, 
				"plan": "TCM", 
				"avales": "NO", 
				"descTipoGtia": "None", 
				"claveLarga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
				"claveCorta": "20fa942020", 
				"asignacion": "aliado", 
				"controlPr": 0, 
				"tipoPreaprobado": "Modificacion", 
				"nivelAlerta": "Bajo", 
				"afectacion": "None", 
				"lineaRedescuento": "", 
				"ofGte": 621, 
				"califeActual": "A", 
				"ciiucenie": 4530, 
				"saldoCliente": 5220000.03, 
				"calife": "A", 
				"califintmodred": "AA    ", 
				"califiReal": "C15", 
				"maxMoraCli": 0, 
				"endeudamiento": 7988211.0, 
				"marca026": "None", 
				"altmora": 0.0, 
				"apl": "M", 
				"fdesem": "2022-10-31 00:00:00", 
				"vdesem": 10000000.0, 
				"segCuotaFut": 0.0, 
				"fechaVencDef": "2026-10-30 00:00:00", 
				"fProxPago": "20240416", 
				"plazo": 7, 
				"gerenciado": "   ", 
				"pcons": "TARJETA DE CREDITO", 
				"regcons": "SUR", 
				"sector": "COMERCIO", 
				"subsector": "COMERCIO DE REPUESTOS", 
				"producto": "TARJETA DE CREDITO", 
				"fondo": "None", 
				"obl341": "05303730296619955", 
				"tipoDeTasa": "TASA FIJA MV", 
				"tasa": 0.024103, 
				"tasaAnterior": 0.024103, 
				"idRepLegal": 80887797, 
				"mpioExpCcRepLegal": "None", 
				"dptoExpCcRepLegal": "", 
				"nombreCliRep": "JOSE MOSHE SANDERS BARSTEIN", 
				"marcaPreaprobado": "Preaprobado", 
				"marcaGarantia": "NO", 
				"tipoDeAmortizacion": "Mensual", 
				"tipoCuota": "Capital fijo", 
				"tipoTasa": "TASA FIJA NAMV", 
				"tamanoEmpresa": "micro", 
				"nombreGarantia": "None", 
				"tipoMoneda": 0, 
				"bajoMonto": "X", 
				"descTipoFondo": "None", 
				"proximoPago": 20240318.0, 
				"planDesembolso": "None", 
				"paqueteConsolidacion": "No aplica proceso agil", 
				"procesoAgilConsolidacionPasivos": " ", 
				"cuenta": "5303736042787539259", 
				"saldoCapital": 7804833.37, 
				"cuotasFaltantes": 7, 
				"periodoDeGraciaRestante": "", 
				"spread": 0.0, 
				"periodicidadPago": "Mensual", 
				"modalidad": "Comercial", 
				"interesesAcumulados": 324362.2, 
				"otrosConceptosAcumulados": 42391.56, 
				"tasaSeguroAnual": 0.0, 
				"codBaseSegVida": "", 
				"valorDesembolsoParaSegVida": 0, 
				"mesPagoFng": "", 
				"porcentComisionFng": 0, 
				"mesPagoFag": "", 
				"porcentComisionFag": 0, 
				"saldoTotalVencido": 7988210.25, 
				"saldoCapitalVencido": 7804833.37, 
				"saldoInteresCteVencido": 140985.32, 
				"saldoInteresMoraCausados": 0, 
				"saldoIntMoraEnSuspCausac": 0, 
				"saldoSegurosVencidos": 0, 
				"saldoOtrosSeguros": 0, 
				"comisionExp": 42391.56, 
				"ivaExp": 0, 
				"vlrObligacion": 7988211.0, 
				"pagoMinCons": 1332553.54, 
				"consdocdeu": 63160444, 
				"nombreUsuarioDuenoTarea": "None", 
				"codAbogado": "10026", 
				"nombreAbogado": "AGRUPADOR OBLIGACIONES AL DIA", 
				"grupoAbogado": "AGRUPADORES", 
				"perfilAbogado": "AGRUPADOR PREJURIDICO", 
				"organizacion": 807, 
				"pagaresAConsolidar": "5303730296619955", 
				"fecha1Pror": "", 
				"fecha2Pror": "", 
				"fecha3Pror": "", 
				"dtfTa": None, 
				"ibrNamv": None, 
				"ibrNatv": None, 
				"ibrNasv": None, 
				"ipcVm": None, 
				"ipcVac": None, 
				"ipcVa": None, 
				"idEmbargo": "", 
				"descripcionGestion": "None", 
				"codigoAprobador": "", 
				"fGestionCobdigit": "None", 
				"activo": 1, 
				"year": 2024, 
				"month": 4, 
				"day": 5}]}}}


@mock_dynamodb
def test_graphql_get_preaprobadoscomercial():
	set_up_PreaprobadosComercial()
	executed = graphClient.execute('''
            query ConsultarPreaprobadosComercial($clave:String, $claveOrdenamiento:String, $limit:Int , $ascendente:Boolean , $lastEvaluatedKey:LastEvaluatedKeyPreaprobadosComercial) {
                preaprobadosComercial(clave:$clave, claveOrdenamiento:$claveOrdenamiento, limit:$limit , ascendente:$ascendente , lastEvaluatedKey:$lastEvaluatedKey){clave , claveOrdenamiento , corte , tipoId , nitCliente , razonSocial , segmento , nroOperacion , prorroga , plazomaxProrroga , amplCons , plazominAmplCons , plazomaxAmplCons , amplPgCons , plazominAmplPgCons , plazomaxAmplPgCons , amplMod , plazominAmplMod , plazomaxAmplMod , amplPgMod , plazominAmplPgMod , plazomaxAmplPgMod , amplReest , plazominAmplReest , plazomaxAmplReest , amplPgReest , plazominAmplPgReest , plazomaxAmplPgReest , bin , descripcionBin , cupoMinimo , idPreaprobado , mpioExpCcCliente , dptoExpCcCliente , subsegmento , saldoObligacion , plan , avales , descTipoGtia , claveLarga , claveCorta , asignacion , controlPr , tipoPreaprobado , nivelAlerta , afectacion , lineaRedescuento , ofGte , califeActual , ciiucenie , saldoCliente , calife , califintmodred , califiReal , maxMoraCli , endeudamiento , marca026 , altmora , apl , fdesem , vdesem , segCuotaFut , fechaVencDef , fProxPago , plazo , gerenciado , pcons , regcons , sector , subsector , producto , fondo , obl341 , tipoDeTasa , tasa , tasaAnterior , idRepLegal , mpioExpCcRepLegal , dptoExpCcRepLegal , nombreCliRep , marcaPreaprobado , marcaGarantia , tipoDeAmortizacion , tipoCuota , tipoTasa , tamanoEmpresa , nombreGarantia , tipoMoneda , bajoMonto , descTipoFondo , proximoPago , planDesembolso , paqueteConsolidacion , procesoAgilConsolidacionPasivos , cuenta , saldoCapital , cuotasFaltantes , periodoDeGraciaRestante , spread , periodicidadPago , modalidad , interesesAcumulados , otrosConceptosAcumulados , tasaSeguroAnual , codBaseSegVida , valorDesembolsoParaSegVida , mesPagoFng , porcentComisionFng , mesPagoFag , porcentComisionFag , saldoTotalVencido , saldoCapitalVencido , saldoInteresCteVencido , saldoInteresMoraCausados , saldoIntMoraEnSuspCausac , saldoSegurosVencidos , saldoOtrosSeguros , comisionExp , ivaExp , vlrObligacion , pagoMinCons , consdocdeu , nombreUsuarioDuenoTarea , codAbogado , nombreAbogado , grupoAbogado , perfilAbogado , organizacion , pagaresAConsolidar , fecha1Pror , fecha2Pror , fecha3Pror , dtfTa , ibrNamv , ibrNatv , ibrNasv , ipcVm , ipcVac , ipcVa , idEmbargo , descripcionGestion , codigoAprobador , fGestionCobdigit , activo , year , month , day}
            }''', variables={"clave": "3#20f0e76e9d87260311af2aed333713", "claveOrdenamiento": "5303730296619955#0"})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{
			"preaprobadosComercial":[{
			"clave": "3#20f0e76e9d87260311af2aed333713", 
			"claveOrdenamiento": "5303730296619955#0", 
			"corte": 20240312, 
			"tipoId": 3, 
			"nitCliente": "20f0e76e9d87260311af2aed333713", 
			"razonSocial": "cabd8e7056cdbdcfdde074f7045b95", 
			"segmento": "PYMES", 
			"nroOperacion": "5303730296619955", 
			"prorroga": "None", 
			"plazomaxProrroga": None, 
			"amplCons": "None", 
			"plazominAmplCons": None, 
			"plazomaxAmplCons": None, 
			"amplPgCons": "", 
			"plazominAmplPgCons": None, 
			"plazomaxAmplPgCons": None, 
			"amplMod": "Ampliacion de plazo 36 meses", 
			"plazominAmplMod": 7, 
			"plazomaxAmplMod": 43, 
			"amplPgMod": "", 
			"plazominAmplPgMod": None, 
			"plazomaxAmplPgMod": None, 
			"amplReest": "Ampliacion de plazo 48 meses", 
			"plazominAmplReest": 7, 
			"plazomaxAmplReest": 55, 
			"amplPgReest": "", 
			"plazominAmplPgReest": None, 
			"plazomaxAmplPgReest": None, 
			"bin": 530373, 
			"descripcionBin": "MC CORPORATE", 
			"cupoMinimo": 500000.0, 
			"idPreaprobado": "530373029661995520240311", 
			"mpioExpCcCliente": "", 
			"dptoExpCcCliente": "", 
			"subsegmento": "09 ", 
			"saldoObligacion": 5220000.03, 
			"plan": "TCM", 
			"avales": "NO", 
			"descTipoGtia": "None", 
			"claveLarga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
			"claveCorta": "20fa942020", 
			"asignacion": "aliado", 
			"controlPr": 0, 
			"tipoPreaprobado": "Modificacion", 
			"nivelAlerta": "Bajo", 
			"afectacion": "None", 
			"lineaRedescuento": "", 
			"ofGte": 621, 
			"califeActual": "A", 
			"ciiucenie": 4530, 
			"saldoCliente": 5220000.03, 
			"calife": "A", 
			"califintmodred": "AA    ", 
			"califiReal": "C15", 
			"maxMoraCli": 0, 
			"endeudamiento": 7988211.0, 
			"marca026": "None", 
			"altmora": 0.0, 
			"apl": "M", 
			"fdesem": "2022-10-31 00:00:00", 
			"vdesem": 10000000.0, 
			"segCuotaFut": 0.0, 
			"fechaVencDef": "2026-10-30 00:00:00", 
			"fProxPago": "20240416", 
			"plazo": 7, 
			"gerenciado": "   ", 
			"pcons": "TARJETA DE CREDITO", 
			"regcons": "SUR", 
			"sector": "COMERCIO", 
			"subsector": "COMERCIO DE REPUESTOS", 
			"producto": "TARJETA DE CREDITO", 
			"fondo": "None", 
			"obl341": "05303730296619955", 
			"tipoDeTasa": "TASA FIJA MV", 
			"tasa": 0.024103, 
			"tasaAnterior": 0.024103, 
			"idRepLegal": 80887797, 
			"mpioExpCcRepLegal": "None", 
			"dptoExpCcRepLegal": "", 
			"nombreCliRep": "JOSE MOSHE SANDERS BARSTEIN", 
			"marcaPreaprobado": "Preaprobado", 
			"marcaGarantia": "NO", 
			"tipoDeAmortizacion": "Mensual", 
			"tipoCuota": "Capital fijo", 
			"tipoTasa": "TASA FIJA NAMV", 
			"tamanoEmpresa": "micro", 
			"nombreGarantia": "None", 
			"tipoMoneda": 0, 
			"bajoMonto": "X", 
			"descTipoFondo": "None", 
			"proximoPago": 20240318.0, 
			"planDesembolso": "None", 
			"paqueteConsolidacion": "No aplica proceso agil", 
			"procesoAgilConsolidacionPasivos": " ", 
			"cuenta": "5303736042787539259", 
			"saldoCapital": 7804833.37, 
			"cuotasFaltantes": 7, 
			"periodoDeGraciaRestante": "", 
			"spread": 0.0, 
			"periodicidadPago": "Mensual", 
			"modalidad": "Comercial", 
			"interesesAcumulados": 324362.2, 
			"otrosConceptosAcumulados": 42391.56, 
			"tasaSeguroAnual": 0.0, 
			"codBaseSegVida": "", 
			"valorDesembolsoParaSegVida": 0, 
			"mesPagoFng": "", 
			"porcentComisionFng": 0, 
			"mesPagoFag": "", 
			"porcentComisionFag": 0, 
			"saldoTotalVencido": 7988210.25, 
			"saldoCapitalVencido": 7804833.37, 
			"saldoInteresCteVencido": 140985.32, 
			"saldoInteresMoraCausados": 0, 
			"saldoIntMoraEnSuspCausac": 0, 
			"saldoSegurosVencidos": 0, 
			"saldoOtrosSeguros": 0, 
			"comisionExp": 42391.56, 
			"ivaExp": 0, 
			"vlrObligacion": 7988211.0, 
			"pagoMinCons": 1332553.54, 
			"consdocdeu": 63160444, 
			"nombreUsuarioDuenoTarea": "None", 
			"codAbogado": "10026", 
			"nombreAbogado": "AGRUPADOR OBLIGACIONES AL DIA", 
			"grupoAbogado": "AGRUPADORES", 
			"perfilAbogado": "AGRUPADOR PREJURIDICO", 
			"organizacion": 807, 
			"pagaresAConsolidar": "5303730296619955", 
			"fecha1Pror": "", 
			"fecha2Pror": "", 
			"fecha3Pror": "", 
			"dtfTa": None, 
			"ibrNamv": None, 
			"ibrNatv": None, 
			"ibrNasv": None, 
			"ipcVm": None, 
			"ipcVac": None, 
			"ipcVa": None, 
			"idEmbargo": "", 
			"descripcionGestion": "None", 
			"codigoAprobador": "", 
			"fGestionCobdigit": "None", 
			"activo": 1, 
			"year": 2024, 
			"month": 4, 
			"day": 5}]}}


@mock_dynamodb
def test_graphql_create_preaprobadoscomercial():
	set_up_PreaprobadosComercial()
	executed = graphClient.execute('''
            mutation CrearPreaprobadosComercial($preaprobadosComercialData:PreaprobadosComercialDataInput) {
                createPreaprobadosComercial(preaprobadosComercialData:$preaprobadosComercialData){
                    preaprobadosComercial{
                        clave , claveOrdenamiento , corte , tipoId , nitCliente , razonSocial , segmento , nroOperacion , prorroga , plazomaxProrroga , amplCons , plazominAmplCons , plazomaxAmplCons , amplPgCons , plazominAmplPgCons , plazomaxAmplPgCons , amplMod , plazominAmplMod , plazomaxAmplMod , amplPgMod , plazominAmplPgMod , plazomaxAmplPgMod , amplReest , plazominAmplReest , plazomaxAmplReest , amplPgReest , plazominAmplPgReest , plazomaxAmplPgReest , bin , descripcionBin , cupoMinimo , idPreaprobado , mpioExpCcCliente , dptoExpCcCliente , subsegmento , saldoObligacion , plan , avales , descTipoGtia , claveLarga , claveCorta , asignacion , controlPr , tipoPreaprobado , nivelAlerta , afectacion , lineaRedescuento , ofGte , califeActual , ciiucenie , saldoCliente , calife , califintmodred , califiReal , maxMoraCli , endeudamiento , marca026 , altmora , apl , fdesem , vdesem , segCuotaFut , fechaVencDef , fProxPago , plazo , gerenciado , pcons , regcons , sector , subsector , producto , fondo , obl341 , tipoDeTasa , tasa , tasaAnterior , idRepLegal , mpioExpCcRepLegal , dptoExpCcRepLegal , nombreCliRep , marcaPreaprobado , marcaGarantia , tipoDeAmortizacion , tipoCuota , tipoTasa , tamanoEmpresa , nombreGarantia , tipoMoneda , bajoMonto , descTipoFondo , proximoPago , planDesembolso , paqueteConsolidacion , procesoAgilConsolidacionPasivos , cuenta , saldoCapital , cuotasFaltantes , periodoDeGraciaRestante , spread , periodicidadPago , modalidad , interesesAcumulados , otrosConceptosAcumulados , tasaSeguroAnual , codBaseSegVida , valorDesembolsoParaSegVida , mesPagoFng , porcentComisionFng , mesPagoFag , porcentComisionFag , saldoTotalVencido , saldoCapitalVencido , saldoInteresCteVencido , saldoInteresMoraCausados , saldoIntMoraEnSuspCausac , saldoSegurosVencidos , saldoOtrosSeguros , comisionExp , ivaExp , vlrObligacion , pagoMinCons , consdocdeu , nombreUsuarioDuenoTarea , codAbogado , nombreAbogado , grupoAbogado , perfilAbogado , organizacion , pagaresAConsolidar , fecha1Pror , fecha2Pror , fecha3Pror , dtfTa , ibrNamv , ibrNatv , ibrNasv , ipcVm , ipcVac , ipcVa , idEmbargo , descripcionGestion , codigoAprobador , fGestionCobdigit , activo , year , month , day
                    }}}''', variables={
                "preaprobadosComercialData": {
					"clave": "3#20f0e76e9d87260311af2aed333713", 
					"claveOrdenamiento": "5303730296619955#0", 
					"corte": 20240312, 
					"tipoId": 3, 
					"nitCliente": "20f0e76e9d87260311af2aed333713", 
					"razonSocial": "cabd8e7056cdbdcfdde074f7045b95", 
					"segmento": "PYMES", 
					"nroOperacion": "5303730296619955", 
					"prorroga": "None", 
					"plazomaxProrroga": None, 
					"amplCons": "None", 
					"plazominAmplCons": None, 
					"plazomaxAmplCons": None, 
					"amplPgCons": "", 
					"plazominAmplPgCons": None, 
					"plazomaxAmplPgCons": None, 
					"amplMod": "Ampliacion de plazo 36 meses", 
					"plazominAmplMod": 7, 
					"plazomaxAmplMod": 43, 
					"amplPgMod": "", 
					"plazominAmplPgMod": None, 
					"plazomaxAmplPgMod": None, 
					"amplReest": "Ampliacion de plazo 48 meses", 
					"plazominAmplReest": 7, 
					"plazomaxAmplReest": 55, 
					"amplPgReest": "", 
					"plazominAmplPgReest": None, 
					"plazomaxAmplPgReest": None, 
					"bin": 530373, 
					"descripcionBin": "MC CORPORATE", 
					"cupoMinimo": 500000.0, 
					"idPreaprobado": "530373029661995520240311", 
					"mpioExpCcCliente": "", 
					"dptoExpCcCliente": "", 
					"subsegmento": "09 ", 
					"saldoObligacion": 5220000.03, 
					"plan": "TCM", 
					"avales": "NO", 
					"descTipoGtia": "None", 
					"claveLarga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
					"claveCorta": "20fa942020", 
					"asignacion": "aliado", 
					"controlPr": 0, 
					"tipoPreaprobado": "Modificacion", 
					"nivelAlerta": "Bajo", 
					"afectacion": "None", 
					"lineaRedescuento": "", 
					"ofGte": 621, 
					"califeActual": "A", 
					"ciiucenie": 4530, 
					"saldoCliente": 5220000.03, 
					"calife": "A", 
					"califintmodred": "AA    ", 
					"califiReal": "C15", 
					"maxMoraCli": 0, 
					"endeudamiento": 7988211.0, 
					"marca026": "None", 
					"altmora": 0.0, 
					"apl": "M", 
					"fdesem": "2022-10-31 00:00:00", 
					"vdesem": 10000000.0, 
					"segCuotaFut": 0.0, 
					"fechaVencDef": "2026-10-30 00:00:00", 
					"fProxPago": "20240416", 
					"plazo": 7, 
					"gerenciado": "   ", 
					"pcons": "TARJETA DE CREDITO", 
					"regcons": "SUR", 
					"sector": "COMERCIO", 
					"subsector": "COMERCIO DE REPUESTOS", 
					"producto": "TARJETA DE CREDITO", 
					"fondo": "None", 
					"obl341": "05303730296619955", 
					"tipoDeTasa": "TASA FIJA MV", 
					"tasa": 0.024103, 
					"tasaAnterior": 0.024103, 
					"idRepLegal": 80887797, 
					"mpioExpCcRepLegal": "None", 
					"dptoExpCcRepLegal": "", 
					"nombreCliRep": "JOSE MOSHE SANDERS BARSTEIN", 
					"marcaPreaprobado": "Preaprobado", 
					"marcaGarantia": "NO", 
					"tipoDeAmortizacion": "Mensual", 
					"tipoCuota": "Capital fijo", 
					"tipoTasa": "TASA FIJA NAMV", 
					"tamanoEmpresa": "micro", 
					"nombreGarantia": "None", 
					"tipoMoneda": 0, 
					"bajoMonto": "X", 
					"descTipoFondo": "None", 
					"proximoPago": 20240318.0, 
					"planDesembolso": "None", 
					"paqueteConsolidacion": "No aplica proceso agil", 
					"procesoAgilConsolidacionPasivos": " ", 
					"cuenta": "5303736042787539259", 
					"saldoCapital": 7804833.37, 
					"cuotasFaltantes": 7, 
					"periodoDeGraciaRestante": "", 
					"spread": 0.0, 
					"periodicidadPago": "Mensual", 
					"modalidad": "Comercial", 
					"interesesAcumulados": 324362.2, 
					"otrosConceptosAcumulados": 42391.56, 
					"tasaSeguroAnual": 0.0, 
					"codBaseSegVida": "", 
					"valorDesembolsoParaSegVida": 0, 
					"mesPagoFng": "", 
					"porcentComisionFng": 0, 
					"mesPagoFag": "", 
					"porcentComisionFag": 0, 
					"saldoTotalVencido": 7988210.25, 
					"saldoCapitalVencido": 7804833.37, 
					"saldoInteresCteVencido": 140985.32, 
					"saldoInteresMoraCausados": 0, 
					"saldoIntMoraEnSuspCausac": 0, 
					"saldoSegurosVencidos": 0, 
					"saldoOtrosSeguros": 0, 
					"comisionExp": 42391.56, 
					"ivaExp": 0, 
					"vlrObligacion": 7988211.0, 
					"pagoMinCons": 1332553.54, 
					"consdocdeu": 63160444, 
					"nombreUsuarioDuenoTarea": "None", 
					"codAbogado": "10026", 
					"nombreAbogado": "AGRUPADOR OBLIGACIONES AL DIA", 
					"grupoAbogado": "AGRUPADORES", 
					"perfilAbogado": "AGRUPADOR PREJURIDICO", 
					"organizacion": 807, 
					"pagaresAConsolidar": "5303730296619955", 
					"fecha1Pror": "", 
					"fecha2Pror": "", 
					"fecha3Pror": "", 
					"dtfTa": None, 
					"ibrNamv": None, 
					"ibrNatv": None, 
					"ibrNasv": None, 
					"ipcVm": None, 
					"ipcVac": None, 
					"ipcVa": None, 
					"idEmbargo": "", 
					"descripcionGestion": "None", 
					"codigoAprobador": "", 
					"fGestionCobdigit": "None", 
					"activo": 1, 
					"year": 2024, 
					"month": 4, 
					"day": 5}})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{
			"createPreaprobadosComercial":{
			"preaprobadosComercial":{
			"clave": "3#20f0e76e9d87260311af2aed333713", 
			"claveOrdenamiento": "5303730296619955#0", 
			"corte": 20240312, 
			"tipoId": 3, 
			"nitCliente": "20f0e76e9d87260311af2aed333713", 
			"razonSocial": "cabd8e7056cdbdcfdde074f7045b95", 
			"segmento": "PYMES", 
			"nroOperacion": "5303730296619955", 
			"prorroga": "None", 
			"plazomaxProrroga": None, 
			"amplCons": "None", 
			"plazominAmplCons": None, 
			"plazomaxAmplCons": None, 
			"amplPgCons": "", 
			"plazominAmplPgCons": None, 
			"plazomaxAmplPgCons": None, 
			"amplMod": "Ampliacion de plazo 36 meses", 
			"plazominAmplMod": 7, 
			"plazomaxAmplMod": 43, 
			"amplPgMod": "", 
			"plazominAmplPgMod": None, 
			"plazomaxAmplPgMod": None, 
			"amplReest": "Ampliacion de plazo 48 meses", 
			"plazominAmplReest": 7, 
			"plazomaxAmplReest": 55, 
			"amplPgReest": "", 
			"plazominAmplPgReest": None, 
			"plazomaxAmplPgReest": None, 
			"bin": 530373, 
			"descripcionBin": "MC CORPORATE", 
			"cupoMinimo": 500000.0, 
			"idPreaprobado": "530373029661995520240311", 
			"mpioExpCcCliente": "", 
			"dptoExpCcCliente": "", 
			"subsegmento": "09 ", 
			"saldoObligacion": 5220000.03, 
			"plan": "TCM", 
			"avales": "NO", 
			"descTipoGtia": "None", 
			"claveLarga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
			"claveCorta": "20fa942020", 
			"asignacion": "aliado", 
			"controlPr": 0, 
			"tipoPreaprobado": "Modificacion", 
			"nivelAlerta": "Bajo", 
			"afectacion": "None", 
			"lineaRedescuento": "", 
			"ofGte": 621, 
			"califeActual": "A", 
			"ciiucenie": 4530, 
			"saldoCliente": 5220000.03, 
			"calife": "A", 
			"califintmodred": "AA    ", 
			"califiReal": "C15", 
			"maxMoraCli": 0, 
			"endeudamiento": 7988211.0, 
			"marca026": "None", 
			"altmora": 0.0, 
			"apl": "M", 
			"fdesem": "2022-10-31 00:00:00", 
			"vdesem": 10000000.0, 
			"segCuotaFut": 0.0, 
			"fechaVencDef": "2026-10-30 00:00:00", 
			"fProxPago": "20240416", 
			"plazo": 7, 
			"gerenciado": "   ", 
			"pcons": "TARJETA DE CREDITO", 
			"regcons": "SUR", 
			"sector": "COMERCIO", 
			"subsector": "COMERCIO DE REPUESTOS", 
			"producto": "TARJETA DE CREDITO", 
			"fondo": "None", 
			"obl341": "05303730296619955", 
			"tipoDeTasa": "TASA FIJA MV", 
			"tasa": 0.024103, 
			"tasaAnterior": 0.024103, 
			"idRepLegal": 80887797, 
			"mpioExpCcRepLegal": "None", 
			"dptoExpCcRepLegal": "", 
			"nombreCliRep": "JOSE MOSHE SANDERS BARSTEIN", 
			"marcaPreaprobado": "Preaprobado", 
			"marcaGarantia": "NO", 
			"tipoDeAmortizacion": "Mensual", 
			"tipoCuota": "Capital fijo", 
			"tipoTasa": "TASA FIJA NAMV", 
			"tamanoEmpresa": "micro", 
			"nombreGarantia": "None", 
			"tipoMoneda": 0, 
			"bajoMonto": "X", 
			"descTipoFondo": "None", 
			"proximoPago": 20240318.0, 
			"planDesembolso": "None", 
			"paqueteConsolidacion": "No aplica proceso agil", 
			"procesoAgilConsolidacionPasivos": " ", 
			"cuenta": "5303736042787539259", 
			"saldoCapital": 7804833.37, 
			"cuotasFaltantes": 7, 
			"periodoDeGraciaRestante": "", 
			"spread": 0.0, 
			"periodicidadPago": "Mensual", 
			"modalidad": "Comercial", 
			"interesesAcumulados": 324362.2, 
			"otrosConceptosAcumulados": 42391.56, 
			"tasaSeguroAnual": 0.0, 
			"codBaseSegVida": "", 
			"valorDesembolsoParaSegVida": 0, 
			"mesPagoFng": "", 
			"porcentComisionFng": 0, 
			"mesPagoFag": "", 
			"porcentComisionFag": 0, 
			"saldoTotalVencido": 7988210.25, 
			"saldoCapitalVencido": 7804833.37, 
			"saldoInteresCteVencido": 140985.32, 
			"saldoInteresMoraCausados": 0, 
			"saldoIntMoraEnSuspCausac": 0, 
			"saldoSegurosVencidos": 0, 
			"saldoOtrosSeguros": 0, 
			"comisionExp": 42391.56, 
			"ivaExp": 0, 
			"vlrObligacion": 7988211.0, 
			"pagoMinCons": 1332553.54, 
			"consdocdeu": 63160444, 
			"nombreUsuarioDuenoTarea": "None", 
			"codAbogado": "10026", 
			"nombreAbogado": "AGRUPADOR OBLIGACIONES AL DIA", 
			"grupoAbogado": "AGRUPADORES", 
			"perfilAbogado": "AGRUPADOR PREJURIDICO", 
			"organizacion": 807, 
			"pagaresAConsolidar": "5303730296619955", 
			"fecha1Pror": "", 
			"fecha2Pror": "", 
			"fecha3Pror": "", 
			"dtfTa": None, 
			"ibrNamv": None, 
			"ibrNatv": None, 
			"ibrNasv": None, 
			"ipcVm": None, 
			"ipcVac": None, 
			"ipcVa": None, 
			"idEmbargo": "", 
			"descripcionGestion": "None", 
			"codigoAprobador": "", 
			"fGestionCobdigit": "None", 
			"activo": 1, 
			"year": 2024, 
			"month": 4, 
			"day": 5}}}}


@mock_dynamodb
def test_graphql_delete_preaprobadoscomercial():
	set_up_PreaprobadosComercial()
	executed = graphClient.execute('''
            mutation BorrarPreaprobadosComercial($preaprobadosComercialData:PreaprobadosComercialDataInput) {
                deletePreaprobadosComercial(preaprobadosComercialData:$preaprobadosComercialData){status}
            }''', variables={"preaprobadosComercialData": {"clave": "3#20f0e76e9d87260311af2aed333713", "claveOrdenamiento": "5303730296619955#0"}})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{"deletePreaprobadosComercial":{"status":True}}}


@mock_dynamodb
def test_graphql_get_tdctasasportal_all():
	set_up_TdcTasasPortal()
	executed = graphClient.execute('''
            query ConsultarTdcTasasPortalAll($clave:String, $claveOrdenamiento:String, $limit:Int , $ascendente:Boolean , $lastEvaluatedKey:LastEvaluatedKeyTdcTasasPortal) {
            tdcTasasPortalAll(clave:$clave, claveOrdenamiento:$claveOrdenamiento, limit:$limit , ascendente:$ascendente , lastEvaluatedKey:$lastEvaluatedKey){
            totalCount,
            tdctasasportal{
                clave , claveOrdenamiento , ingestionYear , ingestionMonth , ingestionDay , costumerNumber , tipoIdCliente , idCliente , nombreCliente , tipoIdAmparador , idAmparador , nombreAmparador , organizacion , cuenta , estadoCuenta , blockCode1 , blockCode2 , diasMora , tarjeta , bin , ultimos4Numeros , franquicia , estadoTarjeta , blockCodeTarjeta , ciclo , fechaUltimoCorte , fechaLimiteDePago , fechaProximoCorte , diasProximoCorte , transacionesSuspendidas , montoTransacionesSuspendidas , deudaTotal , comisionesDeudaTotal , interesesDeudaTotal , sumaComisionesInteresesDeudaTotal , capitalDeudaTotal , tasaPonderadaDeudaTotal , tasaParetoDeudaTotal , codigoTransaccionDeudaTotal , pagoMinimoPendiente , comisionesPagoMinimoPendiente , interesesPagoMinimoPendiente , sumaComisionesInteresesPagoMinimoPendiente , capitalPagoMinimoPendiente , tasaPonderadaPagoMinimo , tasaParetoPagoMinimo , codigoTransaccionPagoMinimo , plazoMaximo , plazoRango , fechaRegistro , horaRegistro , fechaSaldos , fechaReg , tasaPolitica , year , month , activo
                }
            }
            }''', variables={"clave": "1#ec93f229ac2a8198e5ba39c5daf373", "claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806"})
            
	assert json.loads(json.dumps(executed)) =={
		"data":{
			"tdcTasasPortalAll":{
				"totalCount": 1,
				"tdctasasportal":[{
				"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
				"claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
				"ingestionYear": 2024, 
				"ingestionMonth": 3, 
				"ingestionDay": 15, 
				"costumerNumber": "969e7c9f478b58b893736ff9a69f9b", 
				"tipoIdCliente": "1", 
				"idCliente": "ec93f229ac2a8198e5ba39c5daf373", 
				"nombreCliente": "0434ac7a93ecca2950f9cbadb6f819", 
				"tipoIdAmparador": " ", 
				"idAmparador": "                         ", 
				"nombreAmparador": "                                        ", 
				"organizacion": 806, 
				"cuenta": "3778157021107407756", 
				"estadoCuenta": "A", 
				"blockCode1": " ", 
				"blockCode2": " ", 
				"diasMora": 0, 
				"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
				"bin": "377815", 
				"ultimos4Numeros": "9465", 
				"franquicia": "AMEX  ", 
				"estadoTarjeta": "0", 
				"blockCodeTarjeta": " ", 
				"ciclo": 15, 
				"fechaUltimoCorte": "20240215", 
				"fechaLimiteDePago": "20240304", 
				"fechaProximoCorte": "20240315", 
				"diasProximoCorte": 0, 
				"transacionesSuspendidas": 0, 
				"montoTransacionesSuspendidas": 0, 
				"deudaTotal": 63.16, 
				"comisionesDeudaTotal": 0, 
				"interesesDeudaTotal": 0, 
				"sumaComisionesInteresesDeudaTotal": 0, 
				"capitalDeudaTotal": 63.16, 
				"tasaPonderadaDeudaTotal": 0.02419200, 
				"tasaParetoDeudaTotal": 0.02419200, 
				"codigoTransaccionDeudaTotal": "8098 ", 
				"pagoMinimoPendiente": 0, 
				"comisionesPagoMinimoPendiente": 0, 
				"interesesPagoMinimoPendiente": 0, 
				"sumaComisionesInteresesPagoMinimoPendiente": 0, 
				"capitalPagoMinimoPendiente": 0, 
				"tasaPonderadaPagoMinimo": 0, 
				"tasaParetoPagoMinimo": 0, 
				"codigoTransaccionPagoMinimo": "8304 ", 
				"plazoMaximo": "34 ", 
				"plazoRango": "36 ", 
				"fechaRegistro": "15/03/2024", 
				"horaRegistro": "03:51:52", 
				"fechaSaldos": "14/03/2024", 
				"fechaReg": 20240315, 
				"tasaPolitica": 0.02419200, 
				"year": 2024, 
				"month": 3, 
				"activo": 1}]}}}


@mock_dynamodb
def test_graphql_get_tdctasasportal():
	set_up_TdcTasasPortal()
	executed = graphClient.execute('''
            query ConsultarTdcTasasPortal($clave:String, $claveOrdenamiento:String, $limit:Int , $ascendente:Boolean , $lastEvaluatedKey:LastEvaluatedKeyTdcTasasPortal) {
                tdcTasasPortal(clave:$clave, claveOrdenamiento:$claveOrdenamiento, limit:$limit , ascendente:$ascendente , lastEvaluatedKey:$lastEvaluatedKey){clave , claveOrdenamiento , ingestionYear , ingestionMonth , ingestionDay , costumerNumber , tipoIdCliente , idCliente , nombreCliente , tipoIdAmparador , idAmparador , nombreAmparador , organizacion , cuenta , estadoCuenta , blockCode1 , blockCode2 , diasMora , tarjeta , bin , ultimos4Numeros , franquicia , estadoTarjeta , blockCodeTarjeta , ciclo , fechaUltimoCorte , fechaLimiteDePago , fechaProximoCorte , diasProximoCorte , transacionesSuspendidas , montoTransacionesSuspendidas , deudaTotal , comisionesDeudaTotal , interesesDeudaTotal , sumaComisionesInteresesDeudaTotal , capitalDeudaTotal , tasaPonderadaDeudaTotal , tasaParetoDeudaTotal , codigoTransaccionDeudaTotal , pagoMinimoPendiente , comisionesPagoMinimoPendiente , interesesPagoMinimoPendiente , sumaComisionesInteresesPagoMinimoPendiente , capitalPagoMinimoPendiente , tasaPonderadaPagoMinimo , tasaParetoPagoMinimo , codigoTransaccionPagoMinimo , plazoMaximo , plazoRango , fechaRegistro , horaRegistro , fechaSaldos , fechaReg , tasaPolitica , year , month , activo}
            }''', variables={"clave": "1#ec93f229ac2a8198e5ba39c5daf373", "claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806"})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{
			"tdcTasasPortal":[{
			"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
			"claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
			"ingestionYear": 2024, 
			"ingestionMonth": 3, 
			"ingestionDay": 15, 
			"costumerNumber": "969e7c9f478b58b893736ff9a69f9b", 
			"tipoIdCliente": "1", 
			"idCliente": "ec93f229ac2a8198e5ba39c5daf373", 
			"nombreCliente": "0434ac7a93ecca2950f9cbadb6f819", 
			"tipoIdAmparador": " ", 
			"idAmparador": "                         ", 
			"nombreAmparador": "                                        ", 
			"organizacion": 806, 
			"cuenta": "3778157021107407756", 
			"estadoCuenta": "A", 
			"blockCode1": " ", 
			"blockCode2": " ", 
			"diasMora": 0, 
			"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
			"bin": "377815", 
			"ultimos4Numeros": "9465", 
			"franquicia": "AMEX  ", 
			"estadoTarjeta": "0", 
			"blockCodeTarjeta": " ", 
			"ciclo": 15, 
			"fechaUltimoCorte": "20240215", 
			"fechaLimiteDePago": "20240304", 
			"fechaProximoCorte": "20240315", 
			"diasProximoCorte": 0, 
			"transacionesSuspendidas": 0, 
			"montoTransacionesSuspendidas": 0, 
			"deudaTotal": 63.16, 
			"comisionesDeudaTotal": 0, 
			"interesesDeudaTotal": 0, 
			"sumaComisionesInteresesDeudaTotal": 0, 
			"capitalDeudaTotal": 63.16, 
			"tasaPonderadaDeudaTotal": 0.02419200, 
			"tasaParetoDeudaTotal": 0.02419200, 
			"codigoTransaccionDeudaTotal": "8098 ", 
			"pagoMinimoPendiente": 0, 
			"comisionesPagoMinimoPendiente": 0, 
			"interesesPagoMinimoPendiente": 0, 
			"sumaComisionesInteresesPagoMinimoPendiente": 0, 
			"capitalPagoMinimoPendiente": 0, 
			"tasaPonderadaPagoMinimo": 0, 
			"tasaParetoPagoMinimo": 0, 
			"codigoTransaccionPagoMinimo": "8304 ", 
			"plazoMaximo": "34 ", 
			"plazoRango": "36 ", 
			"fechaRegistro": "15/03/2024", 
			"horaRegistro": "03:51:52", 
			"fechaSaldos": "14/03/2024", 
			"fechaReg": 20240315, 
			"tasaPolitica": 0.02419200, 
			"year": 2024, 
			"month": 3, 
			"activo": 1}]}}


@mock_dynamodb
def test_graphql_create_tdctasasportal():
	set_up_TdcTasasPortal()
	executed = graphClient.execute('''
            mutation CrearTdcTasasPortal($tdcTasasPortalData:TdcTasasPortalDataInput) {
                createTdcTasasPortal(tdcTasasPortalData:$tdcTasasPortalData){
                    tdcTasasPortal{
                        clave , claveOrdenamiento , ingestionYear , ingestionMonth , ingestionDay , costumerNumber , tipoIdCliente , idCliente , nombreCliente , tipoIdAmparador , idAmparador , nombreAmparador , organizacion , cuenta , estadoCuenta , blockCode1 , blockCode2 , diasMora , tarjeta , bin , ultimos4Numeros , franquicia , estadoTarjeta , blockCodeTarjeta , ciclo , fechaUltimoCorte , fechaLimiteDePago , fechaProximoCorte , diasProximoCorte , transacionesSuspendidas , montoTransacionesSuspendidas , deudaTotal , comisionesDeudaTotal , interesesDeudaTotal , sumaComisionesInteresesDeudaTotal , capitalDeudaTotal , tasaPonderadaDeudaTotal , tasaParetoDeudaTotal , codigoTransaccionDeudaTotal , pagoMinimoPendiente , comisionesPagoMinimoPendiente , interesesPagoMinimoPendiente , sumaComisionesInteresesPagoMinimoPendiente , capitalPagoMinimoPendiente , tasaPonderadaPagoMinimo , tasaParetoPagoMinimo , codigoTransaccionPagoMinimo , plazoMaximo , plazoRango , fechaRegistro , horaRegistro , fechaSaldos , fechaReg , tasaPolitica , year , month , activo
                    }}}''', variables={
                "tdcTasasPortalData": {
					"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
					"claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
					"ingestionYear": 2024, 
					"ingestionMonth": 3, 
					"ingestionDay": 15, 
					"costumerNumber": "969e7c9f478b58b893736ff9a69f9b", 
					"tipoIdCliente": "1", 
					"idCliente": "ec93f229ac2a8198e5ba39c5daf373", 
					"nombreCliente": "0434ac7a93ecca2950f9cbadb6f819", 
					"tipoIdAmparador": " ", 
					"idAmparador": "                         ", 
					"nombreAmparador": "                                        ", 
					"organizacion": 806, 
					"cuenta": "3778157021107407756", 
					"estadoCuenta": "A", 
					"blockCode1": " ", 
					"blockCode2": " ", 
					"diasMora": 0, 
					"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
					"bin": "377815", 
					"ultimos4Numeros": "9465", 
					"franquicia": "AMEX  ", 
					"estadoTarjeta": "0", 
					"blockCodeTarjeta": " ", 
					"ciclo": 15, 
					"fechaUltimoCorte": "20240215", 
					"fechaLimiteDePago": "20240304", 
					"fechaProximoCorte": "20240315", 
					"diasProximoCorte": 0, 
					"transacionesSuspendidas": 0, 
					"montoTransacionesSuspendidas": 0, 
					"deudaTotal": 63.16, 
					"comisionesDeudaTotal": 0, 
					"interesesDeudaTotal": 0, 
					"sumaComisionesInteresesDeudaTotal": 0, 
					"capitalDeudaTotal": 63.16, 
					"tasaPonderadaDeudaTotal": 0.02419200, 
					"tasaParetoDeudaTotal": 0.02419200, 
					"codigoTransaccionDeudaTotal": "8098 ", 
					"pagoMinimoPendiente": 0, 
					"comisionesPagoMinimoPendiente": 0, 
					"interesesPagoMinimoPendiente": 0, 
					"sumaComisionesInteresesPagoMinimoPendiente": 0, 
					"capitalPagoMinimoPendiente": 0, 
					"tasaPonderadaPagoMinimo": 0, 
					"tasaParetoPagoMinimo": 0, 
					"codigoTransaccionPagoMinimo": "8304 ", 
					"plazoMaximo": "34 ", 
					"plazoRango": "36 ", 
					"fechaRegistro": "15/03/2024", 
					"horaRegistro": "03:51:52", 
					"fechaSaldos": "14/03/2024", 
					"fechaReg": 20240315, 
					"tasaPolitica": 0.02419200, 
					"year": 2024, 
					"month": 3, 
					"activo": 1}})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{
			"createTdcTasasPortal":{
			"tdcTasasPortal":{
			"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
			"claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
			"ingestionYear": 2024, 
			"ingestionMonth": 3, 
			"ingestionDay": 15, 
			"costumerNumber": "969e7c9f478b58b893736ff9a69f9b", 
			"tipoIdCliente": "1", 
			"idCliente": "ec93f229ac2a8198e5ba39c5daf373", 
			"nombreCliente": "0434ac7a93ecca2950f9cbadb6f819", 
			"tipoIdAmparador": " ", 
			"idAmparador": "                         ", 
			"nombreAmparador": "                                        ", 
			"organizacion": 806, 
			"cuenta": "3778157021107407756", 
			"estadoCuenta": "A", 
			"blockCode1": " ", 
			"blockCode2": " ", 
			"diasMora": 0, 
			"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
			"bin": "377815", 
			"ultimos4Numeros": "9465", 
			"franquicia": "AMEX  ", 
			"estadoTarjeta": "0", 
			"blockCodeTarjeta": " ", 
			"ciclo": 15, 
			"fechaUltimoCorte": "20240215", 
			"fechaLimiteDePago": "20240304", 
			"fechaProximoCorte": "20240315", 
			"diasProximoCorte": 0, 
			"transacionesSuspendidas": 0, 
			"montoTransacionesSuspendidas": 0, 
			"deudaTotal": 63.16, 
			"comisionesDeudaTotal": 0, 
			"interesesDeudaTotal": 0, 
			"sumaComisionesInteresesDeudaTotal": 0, 
			"capitalDeudaTotal": 63.16, 
			"tasaPonderadaDeudaTotal": 0.02419200, 
			"tasaParetoDeudaTotal": 0.02419200, 
			"codigoTransaccionDeudaTotal": "8098 ", 
			"pagoMinimoPendiente": 0, 
			"comisionesPagoMinimoPendiente": 0, 
			"interesesPagoMinimoPendiente": 0, 
			"sumaComisionesInteresesPagoMinimoPendiente": 0, 
			"capitalPagoMinimoPendiente": 0, 
			"tasaPonderadaPagoMinimo": 0, 
			"tasaParetoPagoMinimo": 0, 
			"codigoTransaccionPagoMinimo": "8304 ", 
			"plazoMaximo": "34 ", 
			"plazoRango": "36 ", 
			"fechaRegistro": "15/03/2024", 
			"horaRegistro": "03:51:52", 
			"fechaSaldos": "14/03/2024", 
			"fechaReg": 20240315, 
			"tasaPolitica": 0.02419200, 
			"year": 2024, 
			"month": 3, 
			"activo": 1}}}}


@mock_dynamodb
def test_graphql_delete_tdctasasportal():
	set_up_TdcTasasPortal()
	executed = graphClient.execute('''
            mutation BorrarTdcTasasPortal($tdcTasasPortalData:TdcTasasPortalDataInput) {
                deleteTdcTasasPortal(tdcTasasPortalData:$tdcTasasPortalData){status}
            }''', variables={"tdcTasasPortalData": {"clave": "1#ec93f229ac2a8198e5ba39c5daf373", "claveOrdenamiento": "5a783d608dda9d0a731a9b288dc694#806"}})
            
	assert json.loads(json.dumps(executed)) == {
		"data":{"deleteTdcTasasPortal":{"status":True}}}


# PRUEBAS CON REST
@mock_dynamodb
def test_rest_get_preaprobadosconsumocombos():
	set_up_PreaprobadosConsumoCombos()
	body = {"data":[{"clave": "1#20f123cb641265b58fab2fd417e812", "clave_ordenamiento": "16781043120"}]}
	response = restClient.post('/get_preaprobados_consumo_combos', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == [{
		"clave": "1#20f123cb641265b58fab2fd417e812", 
		"clave_ordenamiento": "16781043120", 
		"tipoid": "1", 
		"id": "20f123cb641265b58fab2fd417e812", 
		"nombre_cliente": "e5ebb7e36531f9a3768e25c82272ef", 
		"segmento": "PERSONAL", 
		"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
		"tel1": 3148160885, 
		"tel2": 3118080627, 
		"tel3": None, 
		"tel4": None, 
		"tel5": None, 
		"tel6": 18685227, 
		"tel7": None, 
		"tel8": None, 
		"tel9": None, 
		"tel10": None, 
		"ciudad_contacto": "BOGOTA D.C.", 
		"cupo_asigando_crediagil": "", 
		"num_prestamo": 16781043120, 
		"valor_desembolso": 500000.00, 
		"tipo_plan": "P04", 
		"producto": "CONSUMO", 
		"plazo_actual": 60, 
		"frecuencia_pago": "Mensual", 
		"tasa_namv": 0.223255, 
		"tipo_de_tasa": "Tasa Fija NAMV", 
		"fecha_desembolso": "2021-08-28", 
		"fecha_vencimiento": "2026-09-15", 
		"nueva_fecha_vencimiento": "", 
		"saldo_neto": 320121.00, 
		"cuota_regular": 14502.00, 
		"cuota_incluye_seguro": "SI", 
		"cuota_fija_k": 0, 
		"tipo_de_cuota": "cuota regular", 
		"intereses_pendientes": 3971.00, 
		"saldo_sg_vida": 400.00, 
		"fecha_prox_pago": "15-04-2024", 
		"nueva_fecha_prox_pago": "", 
		"fecha_ultimo_pago": "2024/03/15", 
		"num_cuotas_faltantes": 30, 
		"plazo_min": 36, 
		"plazo_max": 66, 
		"ampliacion_plazo_meses": 36, 
		"max_periodo_de_gracia_o_prorroga": 2, 
		"meses_prorroga_elegidos": 1, 
		"nuevo_plazo_total_en_meses": "", 
		"mes_pago_fng": "", 
		"monto_fng": "", 
		"mes_pago_comision_mipyme": "", 
		"monto_comision_mipyme": None, 
		"frec_mipyme": "", 
		"comision_mipyme_fng": "", 
		"cuota_anterior": 14502.00, 
		"vlr_cuota_actual": 14502.00, 
		"nueva_cuota_sin_otros_conceptos": "", 
		"nueva_cuota_a_capital": "", 
		"nueva_cuota_total": "", 
		"disminucion_de_cuota": "", 
		"nueva_cuota_sistema": "", 
		"marca_riesgos": "1", 
		"genero": "F", 
		"fecha_nacimiento": 19800609, 
		"email_1": "d240fa6f8e@correo.com", 
		"email_2": "d240fa6f8e@correo.com", 
		"nueva_g": "", 
		"region": "BOGOTA Y CUNDINAMARCA", 
		"codigo_seg_vida": 2, 
		"extraprima_seguro": 0, 
		"factor_seguro": 0.014400000, 
		"seguro_desempleo": 0, 
		"prob": "OTRO", 
		"televentas_habeas_data": "None", 
		"mail_habeas_data": "None", 
		"sms_habeas_data": "None", 
		"departamento": "BOGOTA D.C.    ", 
		"aliado": "KONECTA COBRANZA", 
		"base": "reactivo doc", 
		"opcion_1": "1.Ampliacion/2.Combo", 
		"opcion_2": "1.Prorroga", 
		"prioridad_creditos": 12, 
		"fecha_proyprox_pago": 20240415, 
		"redescuento": 0, 
		"concepto_distribucion1": 5, 
		"conector_distribucion1": "&", 
		"concepto_distribucion2": 2, 
		"conector_distribucion2": "&", 
		"concepto_distribucion3": 1, 
		"conector_distribucion3": "+", 
		"concepto_distribucion4": 6, 
		"conector_distribucion4": "+", 
		"concepto_distribucion5": 16, 
		"conector_distribucion5": "+", 
		"concepto_distribucion6": 17, 
		"conector_distribucion6": " ", 
		"concepto_distribucion7": 0, 
		"conector_distribucion7": " ", 
		"concepto_distribucion8": 0, 
		"conector_distribucion8": " ", 
		"concepto_distribucion9": 0, 
		"estado": "", 
		"base_aliados": "", 
		"nombre": "CARTERA PARA COBRO", 
		"grupo": "AGRUPADORES", 
		"perfil": "AGRUPADOR PREJURIDICO", 
		"cod_abogado": "999", 
		"cod_abogado_para": "999", 
		"dias_mora": 0, 
		"nombre_para": "CARTERA PARA COBRO", 
		"grupo_para": "AGRUPADORES", 
		"perfil_para": "AGRUPADOR PREJURIDICO", 
		"cobro_juridico": "None", 
		"fuente": "al dia", 
		"cnt_dias_mora": 0, 
		"consdocdeu": 53466878, 
		"nueva_marca": "", 
		"venezolanos": "No", 
		"canal_rpc_semana": "None", 
		"exclusion_rpc": "", 
		"exclusion_lc": "", 
		"novedad": "None", 
		"alternativa_aplicada_agr": "None", 
		"marca_agrupada_rgo": "None", 
		"producto_agrupado_origen": "None", 
		"f_aplicacion": None, 
		"bpo": "Sin otras aceptaciones", 
		"exclusion_alt": "", 
		"activo": 1, 
		"year": 2024, 
		"month": 4, 
		"day": 5}]


@mock_dynamodb
def test_rest_set_preaprobadosconsumocombos():
	set_up_PreaprobadosConsumoCombos()
	body = {"data":[{
    	"clave": "1#20f123cb641265b58fab2fd417e812", 
    	"clave_ordenamiento": "16781043120", 
    	"tipoid": "1", 
    	"id": "20f123cb641265b58fab2fd417e812", 
    	"nombre_cliente": "e5ebb7e36531f9a3768e25c82272ef", 
    	"segmento": "PERSONAL", 
    	"ejecutivo": "LUISA MILENA HERNANDEZ SANCHEZ", 
    	"tel1": 3148160885, 
    	"tel2": 3118080627, 
    	"tel3": None, 
    	"tel4": None, 
    	"tel5": None, 
    	"tel6": 18685227, 
    	"tel7": None, 
    	"tel8": None, 
    	"tel9": None, 
    	"tel10": None, 
    	"ciudad_contacto": "BOGOTA D.C.", 
    	"cupo_asigando_crediagil": "", 
    	"num_prestamo": 16781043120, 
    	"valor_desembolso": 500000.00, 
    	"tipo_plan": "P04", 
    	"producto": "CONSUMO", 
    	"plazo_actual": 60, 
    	"frecuencia_pago": "Mensual", 
    	"tasa_namv": 0.223255, 
    	"tipo_de_tasa": "Tasa Fija NAMV", 
    	"fecha_desembolso": "2021-08-28", 
    	"fecha_vencimiento": "2026-09-15", 
    	"nueva_fecha_vencimiento": "", 
    	"saldo_neto": 320121.00, 
    	"cuota_regular": 14502.00, 
    	"cuota_incluye_seguro": "SI", 
    	"cuota_fija_k": 0, 
    	"tipo_de_cuota": "cuota regular", 
    	"intereses_pendientes": 3971.00, 
    	"saldo_sg_vida": 400.00, 
    	"fecha_prox_pago": "15-04-2024", 
    	"nueva_fecha_prox_pago": "", 
    	"fecha_ultimo_pago": "2024/03/15", 
    	"num_cuotas_faltantes": 30, 
    	"plazo_min": 36, 
    	"plazo_max": 66, 
    	"ampliacion_plazo_meses": 36, 
    	"max_periodo_de_gracia_o_prorroga": 2, 
    	"meses_prorroga_elegidos": 1, 
    	"nuevo_plazo_total_en_meses": "", 
    	"mes_pago_fng": "", 
    	"monto_fng": "", 
    	"mes_pago_comision_mipyme": "", 
    	"monto_comision_mipyme": None, 
    	"frec_mipyme": "", 
    	"comision_mipyme_fng": "", 
    	"cuota_anterior": 14502.00, 
    	"vlr_cuota_actual": 14502.00, 
    	"nueva_cuota_sin_otros_conceptos": "", 
    	"nueva_cuota_a_capital": "", 
    	"nueva_cuota_total": "", 
    	"disminucion_de_cuota": "", 
    	"nueva_cuota_sistema": "", 
    	"marca_riesgos": "1", 
    	"genero": "F", 
    	"fecha_nacimiento": 19800609, 
    	"email_1": "d240fa6f8e@correo.com", 
    	"email_2": "d240fa6f8e@correo.com", 
    	"nueva_g": "", 
    	"region": "BOGOTA Y CUNDINAMARCA", 
    	"codigo_seg_vida": 2, 
    	"extraprima_seguro": 0, 
    	"factor_seguro": 0.014400000, 
    	"seguro_desempleo": 0, 
    	"prob": "OTRO", 
    	"televentas_habeas_data": "None", 
    	"mail_habeas_data": "None", 
    	"sms_habeas_data": "None", 
    	"departamento": "BOGOTA D.C.    ", 
    	"aliado": "KONECTA COBRANZA", 
    	"base": "reactivo doc", 
    	"opcion_1": "1.Ampliacion/2.Combo", 
    	"opcion_2": "1.Prorroga", 
    	"prioridad_creditos": 12, 
    	"fecha_proyprox_pago": 20240415, 
    	"redescuento": 0, 
    	"concepto_distribucion1": 5, 
    	"conector_distribucion1": "&", 
    	"concepto_distribucion2": 2, 
    	"conector_distribucion2": "&", 
    	"concepto_distribucion3": 1, 
    	"conector_distribucion3": "+", 
    	"concepto_distribucion4": 6, 
    	"conector_distribucion4": "+", 
    	"concepto_distribucion5": 16, 
    	"conector_distribucion5": "+", 
    	"concepto_distribucion6": 17, 
    	"conector_distribucion6": " ", 
    	"concepto_distribucion7": 0, 
    	"conector_distribucion7": " ", 
    	"concepto_distribucion8": 0, 
    	"conector_distribucion8": " ", 
    	"concepto_distribucion9": 0, 
    	"estado": "", 
    	"base_aliados": "", 
    	"nombre": "CARTERA PARA COBRO", 
    	"grupo": "AGRUPADORES", 
    	"perfil": "AGRUPADOR PREJURIDICO", 
    	"cod_abogado": "999", 
    	"cod_abogado_para": "999", 
    	"dias_mora": 0, 
    	"nombre_para": "CARTERA PARA COBRO", 
    	"grupo_para": "AGRUPADORES", 
    	"perfil_para": "AGRUPADOR PREJURIDICO", 
    	"cobro_juridico": "None", 
    	"fuente": "al dia", 
    	"cnt_dias_mora": 0, 
    	"consdocdeu": 53466878, 
    	"nueva_marca": "", 
    	"venezolanos": "No", 
    	"canal_rpc_semana": "None", 
    	"exclusion_rpc": "", 
    	"exclusion_lc": "", 
    	"novedad": "None", 
    	"alternativa_aplicada_agr": "None", 
    	"marca_agrupada_rgo": "None", 
    	"producto_agrupado_origen": "None", 
    	"f_aplicacion": None, 
    	"bpo": "Sin otras aceptaciones", 
    	"exclusion_alt": "", 
    	"activo": 1, 
    	"year": 2024, 
    	"month": 4, 
    	"day": 5}]}
	response = restClient.post('/set_preaprobados_consumo_combos', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == ["OK"]


@mock_dynamodb
def test_rest_del_preaprobadosconsumocombos():
	set_up_PreaprobadosConsumoCombos()
	body = {"data":[{"clave": "1#20f123cb641265b58fab2fd417e812", "clave_ordenamiento": "16781043120"}]}
	response = restClient.post('/del_preaprobados_consumo_combos', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == ["('1#20f123cb641265b58fab2fd417e812', '16781043120')"]


@mock_dynamodb
def test_rest_get_preaprobadoscomercial():
	set_up_PreaprobadosComercial()
	body = {"data":[{"clave": "3#20f0e76e9d87260311af2aed333713", "clave_ordenamiento": "5303730296619955#0"}]}
	response = restClient.post('/get_preaprobados_comercial', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == [{
		"clave": "3#20f0e76e9d87260311af2aed333713", 
		"clave_ordenamiento": "5303730296619955#0", 
		"corte": 20240312, 
		"tipo_id": 3, 
		"nit_cliente": "20f0e76e9d87260311af2aed333713", 
		"razon_social": "cabd8e7056cdbdcfdde074f7045b95", 
		"segmento": "PYMES", 
		"nro_operacion": "5303730296619955", 
		"prorroga": "None", 
		"plazomax_prorroga": None, 
		"ampl_cons": "None", 
		"plazomin_ampl_cons": None, 
		"plazomax_ampl_cons": None, 
		"ampl_pg_cons": "", 
		"plazomin_ampl_pg_cons": None, 
		"plazomax_ampl_pg_cons": None, 
		"ampl_mod": "Ampliacion de plazo 36 meses", 
		"plazomin_ampl_mod": 7, 
		"plazomax_ampl_mod": 43, 
		"ampl_pg_mod": "", 
		"plazomin_ampl_pg_mod": None, 
		"plazomax_ampl_pg_mod": None, 
		"ampl_reest": "Ampliacion de plazo 48 meses", 
		"plazomin_ampl_reest": 7, 
		"plazomax_ampl_reest": 55, 
		"ampl_pg_reest": "", 
		"plazomin_ampl_pg_reest": None, 
		"plazomax_ampl_pg_reest": None, 
		"bin": 530373, 
		"descripcion_bin": "MC CORPORATE", 
		"cupo_minimo": 500000.0, 
		"id_preaprobado": "530373029661995520240311", 
		"mpio_exp_cc_cliente": "", 
		"dpto_exp_cc_cliente": "", 
		"subsegmento": "09 ", 
		"saldo_obligacion": 5220000.03, 
		"plan": "TCM", 
		"avales": "NO", 
		"desc_tipo_gtia": "None", 
		"clave_larga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
		"clave_corta": "20fa942020", 
		"asignacion": "aliado", 
		"control_pr": 0, 
		"tipo_preaprobado": "Modificacion", 
		"nivel_alerta": "Bajo", 
		"afectacion": "None", 
		"linea_redescuento": "", 
		"of_gte": 621, 
		"calife_actual": "A", 
		"ciiucenie": 4530, 
		"saldo_cliente": 5220000.03, 
		"calife": "A", 
		"califintmodred": "AA    ", 
		"califi_real": "C15", 
		"max_mora_cli": 0, 
		"endeudamiento": 7988211.0, 
		"marca_026": "None", 
		"altmora": 0.0, 
		"apl": "M", 
		"fdesem": "2022-10-31 00:00:00", 
		"vdesem": 10000000.0, 
		"seg_cuota_fut": 0.0, 
		"fecha_venc_def": "2026-10-30 00:00:00", 
		"f_prox_pago": "20240416", 
		"plazo": 7, 
		"gerenciado": "   ", 
		"pcons": "TARJETA DE CREDITO", 
		"regcons": "SUR", 
		"sector": "COMERCIO", 
		"subsector": "COMERCIO DE REPUESTOS", 
		"producto": "TARJETA DE CREDITO", 
		"fondo": "None", 
		"obl341": "05303730296619955", 
		"tipo_de_tasa": "TASA FIJA MV", 
		"tasa": 0.024103, 
		"tasa_anterior": 0.024103, 
		"id_rep_legal": 80887797, 
		"mpio_exp_cc_rep_legal": "None", 
		"dpto_exp_cc_rep_legal": "", 
		"nombre_cli_rep": "JOSE MOSHE SANDERS BARSTEIN", 
		"marca_preaprobado": "Preaprobado", 
		"marca_garantia": "NO", 
		"tipo_de_amortizacion": "Mensual", 
		"tipo_cuota": "Capital fijo", 
		"tipo_tasa": "TASA FIJA NAMV", 
		"tamano_empresa": "micro", 
		"nombre_garantia": "None", 
		"tipo_moneda": 0, 
		"bajo_monto": "X", 
		"desc_tipo_fondo": "None", 
		"proximo_pago": 20240318.0, 
		"plan_desembolso": "None", 
		"paquete_consolidacion": "No aplica proceso agil", 
		"proceso_agil_consolidacion_pasivos": " ", 
		"cuenta": "5303736042787539259", 
		"saldo_capital": 7804833.37, 
		"cuotas_faltantes": 7, 
		"periodo_de_gracia_restante": "", 
		"spread": 0.0, 
		"periodicidad_pago": "Mensual", 
		"modalidad": "Comercial", 
		"intereses_acumulados": 324362.2, 
		"otros_conceptos_acumulados": 42391.56, 
		"tasa_seguro_anual": 0.0, 
		"cod_base_seg_vida": "", 
		"valor_desembolso_para_seg_vida": 0, 
		"mes_pago_fng": "", 
		"porcent_comision_fng": 0, 
		"mes_pago_fag": "", 
		"porcent_comision_fag": 0, 
		"saldo_total_vencido": 7988210.25, 
		"saldo_capital_vencido": 7804833.37, 
		"saldo_interes_cte_vencido": 140985.32, 
		"saldo_interes_mora_causados": 0, 
		"saldo_int_mora_en_susp_causac": 0, 
		"saldo_seguros_vencidos": 0, 
		"saldo_otros_seguros": 0, 
		"comision_exp": 42391.56, 
		"iva_exp": 0, 
		"vlr_obligacion": 7988211.0, 
		"pago_min_cons": 1332553.54, 
		"consdocdeu": 63160444, 
		"nombre_usuario_dueno_tarea": "None", 
		"cod_abogado": "10026", 
		"nombre_abogado": "AGRUPADOR OBLIGACIONES AL DIA", 
		"grupo_abogado": "AGRUPADORES", 
		"perfil_abogado": "AGRUPADOR PREJURIDICO", 
		"organizacion": 807, 
		"pagares_a_consolidar": "5303730296619955", 
		"fecha1_pror": "", 
		"fecha2_pror": "", 
		"fecha3_pror": "", 
		"dtf_ta": None, 
		"ibr_namv": None, 
		"ibr_natv": None, 
		"ibr_nasv": None, 
		"ipc_vm": None, 
		"ipc_vac": None, 
		"ipc_va": None, 
		"id_embargo": "", 
		"descripcion_gestion": "None", 
		"codigo_aprobador": "", 
		"f_gestion_cobdigit": "None", 
		"activo": 1, 
		"year": 2024, 
		"month": 4, 
		"day": 5}]


@mock_dynamodb
def test_rest_set_preaprobadoscomercial():
	set_up_PreaprobadosComercial()
	body = {"data":[{
    	"clave": "3#20f0e76e9d87260311af2aed333713", 
    	"clave_ordenamiento": "5303730296619955#0", 
    	"corte": 20240312, 
    	"tipo_id": 3, 
    	"nit_cliente": "20f0e76e9d87260311af2aed333713", 
    	"razon_social": "cabd8e7056cdbdcfdde074f7045b95", 
    	"segmento": "PYMES", 
    	"nro_operacion": "5303730296619955", 
    	"prorroga": "None", 
    	"plazomax_prorroga": None, 
    	"ampl_cons": "None", 
    	"plazomin_ampl_cons": None, 
    	"plazomax_ampl_cons": None, 
    	"ampl_pg_cons": "", 
    	"plazomin_ampl_pg_cons": None, 
    	"plazomax_ampl_pg_cons": None, 
    	"ampl_mod": "Ampliacion de plazo 36 meses", 
    	"plazomin_ampl_mod": 7, 
    	"plazomax_ampl_mod": 43, 
    	"ampl_pg_mod": "", 
    	"plazomin_ampl_pg_mod": None, 
    	"plazomax_ampl_pg_mod": None, 
    	"ampl_reest": "Ampliacion de plazo 48 meses", 
    	"plazomin_ampl_reest": 7, 
    	"plazomax_ampl_reest": 55, 
    	"ampl_pg_reest": "", 
    	"plazomin_ampl_pg_reest": None, 
    	"plazomax_ampl_pg_reest": None, 
    	"bin": 530373, 
    	"descripcion_bin": "MC CORPORATE", 
    	"cupo_minimo": 500000.0, 
    	"id_preaprobado": "530373029661995520240311", 
    	"mpio_exp_cc_cliente": "", 
    	"dpto_exp_cc_cliente": "", 
    	"subsegmento": "09 ", 
    	"saldo_obligacion": 5220000.03, 
    	"plan": "TCM", 
    	"avales": "NO", 
    	"desc_tipo_gtia": "None", 
    	"clave_larga": "20fa942020778e1a2234ba1833cded0e7dea47d8c3192b6aff12f31b0ec2c6c8", 
    	"clave_corta": "20fa942020", 
    	"asignacion": "aliado", 
    	"control_pr": 0, 
    	"tipo_preaprobado": "Modificacion", 
    	"nivel_alerta": "Bajo", 
    	"afectacion": "None", 
    	"linea_redescuento": "", 
    	"of_gte": 621, 
    	"calife_actual": "A", 
    	"ciiucenie": 4530, 
    	"saldo_cliente": 5220000.03, 
    	"calife": "A", 
    	"califintmodred": "AA    ", 
    	"califi_real": "C15", 
    	"max_mora_cli": 0, 
    	"endeudamiento": 7988211.0, 
    	"marca_026": "None", 
    	"altmora": 0.0, 
    	"apl": "M", 
    	"fdesem": "2022-10-31 00:00:00", 
    	"vdesem": 10000000.0, 
    	"seg_cuota_fut": 0.0, 
    	"fecha_venc_def": "2026-10-30 00:00:00", 
    	"f_prox_pago": "20240416", 
    	"plazo": 7, 
    	"gerenciado": "   ", 
    	"pcons": "TARJETA DE CREDITO", 
    	"regcons": "SUR", 
    	"sector": "COMERCIO", 
    	"subsector": "COMERCIO DE REPUESTOS", 
    	"producto": "TARJETA DE CREDITO", 
    	"fondo": "None", 
    	"obl341": "05303730296619955", 
    	"tipo_de_tasa": "TASA FIJA MV", 
    	"tasa": 0.024103, 
    	"tasa_anterior": 0.024103, 
    	"id_rep_legal": 80887797, 
    	"mpio_exp_cc_rep_legal": "None", 
    	"dpto_exp_cc_rep_legal": "", 
    	"nombre_cli_rep": "JOSE MOSHE SANDERS BARSTEIN", 
    	"marca_preaprobado": "Preaprobado", 
    	"marca_garantia": "NO", 
    	"tipo_de_amortizacion": "Mensual", 
    	"tipo_cuota": "Capital fijo", 
    	"tipo_tasa": "TASA FIJA NAMV", 
    	"tamano_empresa": "micro", 
    	"nombre_garantia": "None", 
    	"tipo_moneda": 0, 
    	"bajo_monto": "X", 
    	"desc_tipo_fondo": "None", 
    	"proximo_pago": 20240318.0, 
    	"plan_desembolso": "None", 
    	"paquete_consolidacion": "No aplica proceso agil", 
    	"proceso_agil_consolidacion_pasivos": " ", 
    	"cuenta": "5303736042787539259", 
    	"saldo_capital": 7804833.37, 
    	"cuotas_faltantes": 7, 
    	"periodo_de_gracia_restante": "", 
    	"spread": 0.0, 
    	"periodicidad_pago": "Mensual", 
    	"modalidad": "Comercial", 
    	"intereses_acumulados": 324362.2, 
    	"otros_conceptos_acumulados": 42391.56, 
    	"tasa_seguro_anual": 0.0, 
    	"cod_base_seg_vida": "", 
    	"valor_desembolso_para_seg_vida": 0, 
    	"mes_pago_fng": "", 
    	"porcent_comision_fng": 0, 
    	"mes_pago_fag": "", 
    	"porcent_comision_fag": 0, 
    	"saldo_total_vencido": 7988210.25, 
    	"saldo_capital_vencido": 7804833.37, 
    	"saldo_interes_cte_vencido": 140985.32, 
    	"saldo_interes_mora_causados": 0, 
    	"saldo_int_mora_en_susp_causac": 0, 
    	"saldo_seguros_vencidos": 0, 
    	"saldo_otros_seguros": 0, 
    	"comision_exp": 42391.56, 
    	"iva_exp": 0, 
    	"vlr_obligacion": 7988211.0, 
    	"pago_min_cons": 1332553.54, 
    	"consdocdeu": 63160444, 
    	"nombre_usuario_dueno_tarea": "None", 
    	"cod_abogado": "10026", 
    	"nombre_abogado": "AGRUPADOR OBLIGACIONES AL DIA", 
    	"grupo_abogado": "AGRUPADORES", 
    	"perfil_abogado": "AGRUPADOR PREJURIDICO", 
    	"organizacion": 807, 
    	"pagares_a_consolidar": "5303730296619955", 
    	"fecha1_pror": "", 
    	"fecha2_pror": "", 
    	"fecha3_pror": "", 
    	"dtf_ta": None, 
    	"ibr_namv": None, 
    	"ibr_natv": None, 
    	"ibr_nasv": None, 
    	"ipc_vm": None, 
    	"ipc_vac": None, 
    	"ipc_va": None, 
    	"id_embargo": "", 
    	"descripcion_gestion": "None", 
    	"codigo_aprobador": "", 
    	"f_gestion_cobdigit": "None", 
    	"activo": 1, 
    	"year": 2024, 
    	"month": 4, 
    	"day": 5}]}
	response = restClient.post('/set_preaprobados_comercial', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == ["OK"]


@mock_dynamodb
def test_rest_del_preaprobadoscomercial():
	set_up_PreaprobadosComercial()
	body = {"data":[{"clave": "3#20f0e76e9d87260311af2aed333713", "clave_ordenamiento": "5303730296619955#0"}]}
	response = restClient.post('/del_preaprobados_comercial', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == ["('3#20f0e76e9d87260311af2aed333713', '5303730296619955#0')"]


@mock_dynamodb
def test_rest_get_tdctasasportal():
	set_up_TdcTasasPortal()
	body = {"data":[{"clave": "1#ec93f229ac2a8198e5ba39c5daf373", "clave_ordenamiento": "5a783d608dda9d0a731a9b288dc694#806"}]}
	response = restClient.post('/get_tdc_tasas_portal', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == [{
		"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
		"clave_ordenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
		"ingestion_year": 2024, 
		"ingestion_month": 3, 
		"ingestion_day": 15, 
		"costumer_number": "969e7c9f478b58b893736ff9a69f9b", 
		"tipo_id_cliente": "1", 
		"id_cliente": "ec93f229ac2a8198e5ba39c5daf373", 
		"nombre_cliente": "0434ac7a93ecca2950f9cbadb6f819", 
		"tipo_id_amparador": " ", 
		"id_amparador": "                         ", 
		"nombre_amparador": "                                        ", 
		"organizacion": 806, 
		"cuenta": "3778157021107407756", 
		"estado_cuenta": "A", 
		"block_code_1": " ", 
		"block_code_2": " ", 
		"dias_mora": 0, 
		"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
		"bin": "377815", 
		"ultimos_4_numeros": "9465", 
		"franquicia": "AMEX  ", 
		"estado_tarjeta": "0", 
		"block_code_tarjeta": " ", 
		"ciclo": 15, 
		"fecha_ultimo_corte": "20240215", 
		"fecha_limite_de_pago": "20240304", 
		"fecha_proximo_corte": "20240315", 
		"dias_proximo_corte": 0, 
		"transaciones_suspendidas": 0, 
		"monto_transaciones_suspendidas": 0, 
		"deuda_total": 63.16, 
		"comisiones_deuda_total": 0, 
		"intereses_deuda_total": 0, 
		"suma_comisiones_intereses_deuda_total": 0, 
		"capital_deuda_total": 63.16, 
		"tasa_ponderada_deuda_total": 0.02419200, 
		"tasa_pareto_deuda_total": 0.02419200, 
		"codigo_transaccion_deuda_total": "8098 ", 
		"pago_minimo_pendiente": 0, 
		"comisiones_pago_minimo_pendiente": 0, 
		"intereses_pago_minimo_pendiente": 0, 
		"suma_comisiones_intereses_pago_minimo_pendiente": 0, 
		"capital_pago_minimo_pendiente": 0, 
		"tasa_ponderada_pago_minimo": 0, 
		"tasa_pareto_pago_minimo": 0, 
		"codigo_transaccion_pago_minimo": "8304 ", 
		"plazo_maximo": "34 ", 
		"plazo_rango": "36 ", 
		"fecha_registro": "15/03/2024", 
		"hora_registro": "03:51:52", 
		"fecha_saldos": "14/03/2024", 
		"fecha_reg": 20240315, 
		"tasa_politica": 0.02419200, 
		"year": 2024, 
		"month": 3, 
		"activo": 1}]


@mock_dynamodb
def test_rest_set_tdctasasportal():
	set_up_TdcTasasPortal()
	body = {"data":[{
    	"clave": "1#ec93f229ac2a8198e5ba39c5daf373", 
    	"clave_ordenamiento": "5a783d608dda9d0a731a9b288dc694#806", 
    	"ingestion_year": 2024, 
    	"ingestion_month": 3, 
    	"ingestion_day": 15, 
    	"costumer_number": "969e7c9f478b58b893736ff9a69f9b", 
    	"tipo_id_cliente": "1", 
    	"id_cliente": "ec93f229ac2a8198e5ba39c5daf373", 
    	"nombre_cliente": "0434ac7a93ecca2950f9cbadb6f819", 
    	"tipo_id_amparador": " ", 
    	"id_amparador": "                         ", 
    	"nombre_amparador": "                                        ", 
    	"organizacion": 806, 
    	"cuenta": "3778157021107407756", 
    	"estado_cuenta": "A", 
    	"block_code_1": " ", 
    	"block_code_2": " ", 
    	"dias_mora": 0, 
    	"tarjeta": "5a783d608dda9d0a731a9b288dc694", 
    	"bin": "377815", 
    	"ultimos_4_numeros": "9465", 
    	"franquicia": "AMEX  ", 
    	"estado_tarjeta": "0", 
    	"block_code_tarjeta": " ", 
    	"ciclo": 15, 
    	"fecha_ultimo_corte": "20240215", 
    	"fecha_limite_de_pago": "20240304", 
    	"fecha_proximo_corte": "20240315", 
    	"dias_proximo_corte": 0, 
    	"transaciones_suspendidas": 0, 
    	"monto_transaciones_suspendidas": 0, 
    	"deuda_total": 63.16, 
    	"comisiones_deuda_total": 0, 
    	"intereses_deuda_total": 0, 
    	"suma_comisiones_intereses_deuda_total": 0, 
    	"capital_deuda_total": 63.16, 
    	"tasa_ponderada_deuda_total": 0.02419200, 
    	"tasa_pareto_deuda_total": 0.02419200, 
    	"codigo_transaccion_deuda_total": "8098 ", 
    	"pago_minimo_pendiente": 0, 
    	"comisiones_pago_minimo_pendiente": 0, 
    	"intereses_pago_minimo_pendiente": 0, 
    	"suma_comisiones_intereses_pago_minimo_pendiente": 0, 
    	"capital_pago_minimo_pendiente": 0, 
    	"tasa_ponderada_pago_minimo": 0, 
    	"tasa_pareto_pago_minimo": 0, 
    	"codigo_transaccion_pago_minimo": "8304 ", 
    	"plazo_maximo": "34 ", 
    	"plazo_rango": "36 ", 
    	"fecha_registro": "15/03/2024", 
    	"hora_registro": "03:51:52", 
    	"fecha_saldos": "14/03/2024", 
    	"fecha_reg": 20240315, 
    	"tasa_politica": 0.02419200, 
    	"year": 2024, 
    	"month": 3, 
    	"activo": 1}]}
	response = restClient.post('/set_tdc_tasas_portal', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == ["OK"]


@mock_dynamodb
def test_rest_del_tdctasasportal():
	set_up_TdcTasasPortal()
	body = {"data":[{"clave": "1#ec93f229ac2a8198e5ba39c5daf373", "clave_ordenamiento": "5a783d608dda9d0a731a9b288dc694#806"}]}
	response = restClient.post('/del_tdc_tasas_portal', json=body)
	assert response.status_code == 200
	assert json.loads(response.content).get("data", []) == ["('1#ec93f229ac2a8198e5ba39c5daf373', '5a783d608dda9d0a731a9b288dc694#806')"]


# PRUEBAS CASOS DE ERROR
def test_error1():
    response = restClient.post('graphql/', json={"query": ""})
    assert response.status_code == 200

@mock_dynamodb
def test_rest_error_get_preaprobadosconsumocombos():
	body = {"data":[{"clave": "", "clave_ordenamiento": ""}]}
	response = restClient.post('/get_preaprobados_consumo_combos', json=body)
	assert response.status_code == 200

@mock_dynamodb
def test_rest_error_del_preaprobadosconsumocombos():
	body = {"data":[{"clave": "", "clave_ordenamiento": ""}]}
	response = restClient.post('/del_preaprobados_consumo_combos', json=body)
	assert response.status_code == 200

@mock_dynamodb
def test_rest_error_get_preaprobadoscomercial():
	body = {"data":[{"clave": "", "clave_ordenamiento": ""}]}
	response = restClient.post('/get_preaprobados_comercial', json=body)
	assert response.status_code == 200

@mock_dynamodb
def test_rest_error_del_preaprobadoscomercial():
	body = {"data":[{"clave": "", "clave_ordenamiento": ""}]}
	response = restClient.post('/del_preaprobados_comercial', json=body)
	assert response.status_code == 200

@mock_dynamodb
def test_rest_error_get_tdctasasportal():
	body = {"data":[{"clave": "", "clave_ordenamiento": ""}]}
	response = restClient.post('/get_tdc_tasas_portal', json=body)
	assert response.status_code == 200

@mock_dynamodb
def test_rest_error_del_tdctasasportal():
	body = {"data":[{"clave": "", "clave_ordenamiento": ""}]}
	response = restClient.post('/del_tdc_tasas_portal', json=body)
	assert response.status_code == 200

@mock_dynamodb
def test_rest_error1():
	body = {"data":[]}
	response = restClient.post('/get_tdc_tasas_portal', json=body)
	assert response.status_code == 422


@mock_dynamodb
def test_graphql_error1():
	body = {"query":"query ConsultarTdcTasasPortal(){}"}
	response = restClient.post('/graphql/', json=body)
	assert response.status_code == 200



